<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Python for Humanities: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><span class="badge text-bg-warning">
          <abbr title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
              Alpha
            </a>
            <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Python for Humanities
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Python for Humanities
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Python for Humanities
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="short-introduction-to-Python.html">1. Short Introduction to Programming in Python</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="starting-with-data.html">2. Starting With Data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="index-slice-subset.html">3. Indexing, Slicing and Subsetting DataFrames in Python</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="data-types-and-format.html">4. Data Types and Formats</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="merging-data.html">5. Combining DataFrames with pandas</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="loops-and-functions.html">6. Data workflows and automation</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="visualization-ggplot-python.html">7. Plotting</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="working-with-sql.html">8. Accessing SQLite Databases Using Python &amp; Pandas</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="putting-it-all-together.html">9. Putting It All Together</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html"></a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-short-introduction-to-Python"><p>Content from <a href="short-introduction-to-Python.html">Short Introduction to Programming in Python</a></p>
<hr>
<p>Last updated on 2024-05-13 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/short-introduction-to-Python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Python?</li>
<li>Why should I learn Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the advantages of using programming vs. completing
repetitive tasks by hand.</li>
<li>Define the following data types in Python: strings, integers, and
floats.</li>
<li>Perform mathematical operations in Python using basic
operators.</li>
<li>Define the following as it relates to Python: lists, tuples, and
dictionaries.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="the-basics-of-python">The Basics of Python<a class="anchor" aria-label="anchor" href="#the-basics-of-python"></a>
<a class="anchor" aria-label="anchor" href="#the-basics-of-python"></a>
</h2>
<hr class="half-width">
<p>Python is a general purpose programming language that supports rapid
development of scripts and applications.</p>
<p>Python’s main advantages:</p>
<ul>
<li>Open Source software, supported by Python Software Foundation</li>
<li>Available on all platforms</li>
<li>It is a general-purpose programming language</li>
<li>Supports multiple programming paradigms</li>
<li>Very large community with a rich ecosystem of third-party
packages</li>
</ul></section><section><h2 class="section-heading" id="interpreter">Interpreter<a class="anchor" aria-label="anchor" href="#interpreter"></a>
<a class="anchor" aria-label="anchor" href="#interpreter"></a>
</h2>
<hr class="half-width">
<p>Python is an interpreted language which can be used in multiple
ways:</p>
<ul>
<li>
<strong>“Interactive” Mode:</strong> It functions like an “advanced
calculator” Executing one command at a time:</li>
</ul>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>user:host:<span class="op">~</span>$ python</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Python <span class="fl">3.5.1</span> (default, Oct <span class="dv">23</span> <span class="dv">2015</span>, <span class="dv">18</span>:<span class="dv">0</span><span class="er">5</span>:<span class="dv">0</span><span class="er">6</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>[GCC <span class="fl">4.8.3</span>] on linux2</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>Type <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> <span class="kw">or</span> <span class="st">"license"</span> <span class="cf">for</span> more information.</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="st">"Hello World"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>Hello World</span></code></pre>
</div>
<ul>
<li>
<strong>“Scripting” Mode:</strong> Executing a series of “commands”
saved in text file, usually with a <code>.py</code> extension after the
name of your file:</li>
</ul>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">user:host:~$</span> python my_script.py</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">Hello</span> World</span></code></pre>
</div>
<ul>
<li>
<strong>“Cell” Mode:</strong> Commands are stored in specially
formatted and interpreted files that contain independent cells that can
be run seperately in any order we choose. The <strong>Scripting</strong>
and <strong>Interactive</strong> modes are native to python and always
available with any installation. <strong>Cell</strong> mode, on the
other hand, requires software seperate from python itself like
JupyterLab or VS Code with extensions. We will begin using
<strong>Cell</strong> mode shortly after a few more examples using the
built in modes.</li>
</ul></section><section><h2 class="section-heading" id="introduction-to-python-built-in-data-types">Introduction to Python built-in data types<a class="anchor" aria-label="anchor" href="#introduction-to-python-built-in-data-types"></a>
<a class="anchor" aria-label="anchor" href="#introduction-to-python-built-in-data-types"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="strings-integers-and-floats">Strings, integers and floats<a class="anchor" aria-label="anchor" href="#strings-integers-and-floats"></a>
</h3>
<p>Python has built-in numeric types for integers, floats, and complex
numbers. Strings are a built-in textual type.:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span>text <span class="op">=</span> <span class="st">"Data Carpentry"</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> number <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> pi_value <span class="op">=</span> <span class="fl">3.1415</span></span></code></pre>
</div>
<p>Here we’ve assigned data to variables, namely <code>text</code>,
<code>number</code> and <code>pi_value</code>, using the assignment
operator <code>=</code>. The variable called <code>text</code> is a
string which means it can contain letters and numbers. Notice that in
order to define a string you need to have quotes around your text. To
print out the value stored in a variable we can simply type the name of
the variable into the interpreter:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> text</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">"Data Carpentry"</span></span></code></pre>
</div>
<p>However, in a script, a <code>print</code> function is needed to
output the <code>text</code>:</p>
<p><em>example.py</em></p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># A Python script file</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># Comments in Python start with #</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># The next line uses the print function to print out the text string</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"Data Carpentry"</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>number <span class="op">=</span> <span class="dv">42</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>pi_value <span class="op">=</span> <span class="fl">3.1415</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="bu">print</span>(text)</span></code></pre>
</div>
<p><em>Running the script</em></p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">$</span> python example.py</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="ex">Data</span> Carpentry</span></code></pre>
</div>
<p><strong>Tip</strong>: The <code>print</code> function is a built-in
function in Python. Later in this lesson, we will introduce methods and
user-defined functions. The Python documentation is excellent for
reference on the differences between them.</p>
</div>
<div class="section level3">
<h3 id="operators">Operators<a class="anchor" aria-label="anchor" href="#operators"></a>
</h3>
<p>We can perform mathematical calculations in Python using the basic
operators <code>+, -, /, *, %</code>:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span>   <span class="co">#  addition</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">6</span> <span class="op">*</span> <span class="dv">7</span>   <span class="co">#  multiplication</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="dv">42</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">2</span> <span class="op">**</span> <span class="dv">16</span>  <span class="co"># power</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="dv">65536</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">13</span> <span class="op">%</span> <span class="dv">5</span>  <span class="co"># modulo</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="dv">3</span></span></code></pre>
</div>
<p>We can also use comparison and logic operators:
<code>&lt;, &gt;, ==, !=, &lt;=, &gt;=</code> and statements of identity
such as <code>and, or, not</code>. The data type returned by this is
called a <em>boolean</em>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="dv">3</span> <span class="op">&gt;</span> <span class="dv">4</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="va">False</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="va">True</span> <span class="kw">and</span> <span class="va">True</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="va">True</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="va">True</span> <span class="kw">or</span> <span class="va">False</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="va">True</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="sequential-types-lists-and-tuples">Sequential types: Lists and Tuples<a class="anchor" aria-label="anchor" href="#sequential-types-lists-and-tuples"></a>
<a class="anchor" aria-label="anchor" href="#sequential-types-lists-and-tuples"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="lists">Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<p><strong>Lists</strong> are a common data structure to hold an ordered
sequence of elements. Each element can be accessed by an index. Note
that Python indexes start with 0 instead of 1:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers[<span class="dv">0</span>]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="dv">1</span></span></code></pre>
</div>
<p>A <code>for</code> loop can be used to access the elements in a list
or other Python data structure one at a time:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> num <span class="kw">in</span> numbers:</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>...     <span class="bu">print</span>(num)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>...</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<p><strong>Indentation</strong> is very important in Python. Note that
the second line in the example above is indented. Just like three
chevrons <code>&gt;&gt;&gt;</code> indicate an interactive prompt in
Python, the three dots <code>...</code> are Python’s prompt for multiple
lines. This is Python’s way of marking a block of code. [Note: you do
not type <code>&gt;&gt;&gt;</code> or <code>...</code>.]</p>
<p>To add elements to the end of a list, we can use the
<code>append</code> method. Methods are a way to interact with an object
(a list, for example). We can invoke a method using the dot
<code>.</code> followed by the method name and a list of arguments in
parentheses. Let’s look at an example using <code>append</code>:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> numbers.append(<span class="dv">4</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(numbers)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<p>To find out what methods are available for an object, we can use the
built-in <code>help</code> command:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">help</span>(numbers)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>Help on <span class="bu">list</span> <span class="bu">object</span>:</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="kw">class</span> <span class="bu">list</span>(<span class="bu">object</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a> <span class="op">|</span>  <span class="bu">list</span>() <span class="op">-&gt;</span> new empty <span class="bu">list</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a> <span class="op">|</span>  <span class="bu">list</span>(iterable) <span class="op">-&gt;</span> new <span class="bu">list</span> initialized <span class="im">from</span> iterable<span class="st">'s items</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="er"> ...</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="tuples">Tuples<a class="anchor" aria-label="anchor" href="#tuples"></a>
</h3>
<p>A tuple is similar to a list in that it’s an ordered sequence of
elements. However, tuples can not be changed once created (they are
“immutable”). Tuples are created by placing comma-separated values
inside parentheses <code>()</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># tuples use parentheses</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>a_tuple<span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>another_tuple <span class="op">=</span> (<span class="st">'blue'</span>, <span class="st">'green'</span>, <span class="st">'red'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># Note: lists use square brackets</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>a_list <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span></code></pre>
</div>
<div id="challenge---tuples" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---tuples" class="callout-inner">
<h3 class="callout-title">Challenge - Tuples<a class="anchor" aria-label="anchor" href="#challenge---tuples"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens when you type <code>a_tuple[2]=5</code> vs
<code>a_list[1]=5</code> ?</li>
<li>Type <code>type(a_tuple)</code> into python - what is the object
type?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>As a tuple is immutable, it does not support item assignment.
Elements in a list can be altered individually.</p></li>
<li><p><code>tuple</code></p></li>
</ol>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="dictionaries">Dictionaries<a class="anchor" aria-label="anchor" href="#dictionaries"></a>
<a class="anchor" aria-label="anchor" href="#dictionaries"></a>
</h2>
<hr class="half-width">
<p>A <strong>dictionary</strong> is a container that holds pairs of
objects - keys and values.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> translation <span class="op">=</span> {<span class="st">'one'</span>: <span class="dv">1</span>, <span class="st">'two'</span>: <span class="dv">2</span>}</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> translation[<span class="st">'one'</span>]</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="dv">1</span></span></code></pre>
</div>
<p>Dictionaries work a lot like lists - except that you index them with
<em>keys</em>. You can think about a key as a name for or a unique
identifier for a set of values in the dictionary. Keys can only have
particular types - they have to be “hashable”. Strings and numeric types
are acceptable, but lists aren’t.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev[<span class="dv">1</span>]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">'one'</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> bad <span class="op">=</span> {[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]: <span class="dv">3</span>}</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>Traceback (most recent call last):</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  File <span class="st">"&lt;stdin&gt;"</span>, line <span class="dv">1</span>, <span class="kw">in</span> <span class="op">&lt;</span>module<span class="op">&gt;</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="pp">TypeError</span>: unhashable <span class="bu">type</span>: <span class="st">'list'</span></span></code></pre>
</div>
<p>In Python, a “Traceback” is an multi-line error block printed out for
the user.</p>
<p>To add an item to the dictionary we assign a value to a new key:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>}</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev[<span class="dv">3</span>] <span class="op">=</span> <span class="st">'three'</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>{<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'two'</span>, <span class="dv">3</span>: <span class="st">'three'</span>}</span></code></pre>
</div>
<p>Using <code>for</code> loops with dictionaries is a little more
complicated. We can do this in two ways:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> key, value <span class="kw">in</span> rev.items():</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>...     <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, value)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>...</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> one</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> two</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> three</span></code></pre>
</div>
<p>or</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> key <span class="kw">in</span> rev.keys():</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>...     <span class="bu">print</span>(key, <span class="st">'-&gt;'</span>, rev[key])</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>...</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> one</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> two</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> three</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span></span></code></pre>
</div>
<div id="challenge---can-you-do-reassignment-in-a-dictionary" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---can-you-do-reassignment-in-a-dictionary" class="callout-inner">
<h3 class="callout-title">Challenge - Can you do reassignment in a
dictionary?<a class="anchor" aria-label="anchor" href="#challenge---can-you-do-reassignment-in-a-dictionary"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>First check what <code>rev</code> is right now (remember
<code>rev</code> is the name of our dictionary).</li>
</ol>
<p>Type:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> rev</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Try to reassign the second value (in the <em>key value pair</em>)
so that it no longer reads “two” but instead reads
“apple-sauce”.</p></li>
<li><p>Now display <code>rev</code> again to see if it has
changed.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>You should see the following output:
<code>{1: 'one', 2: 'two', 3: 'three'}</code></p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>rev[<span class="dv">2</span>] <span class="op">=</span> <span class="st">"apple-sauce"</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>{<span class="dv">1</span>: <span class="st">'one'</span>, <span class="dv">2</span>: <span class="st">'apple-sauce'</span>, <span class="dv">3</span>: <span class="st">'three'</span>}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Dictionaries as of python 3.7 are now in inserstion order be default.
Anything you see talking about dictionaries beying unordered can be
safely ignored as long as you are using python 3.7 or later.</p>
</section><section><h2 class="section-heading" id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<hr class="half-width">
<p>While functions work just fine in all three modes, let’s open
JupyterLab so we can use <strong>cell</strong> mode moving forward with
the rest of the workshop for the sake of convenience. Let’s do that from
our terminal where in order to save time in the next episode, we will
launch JupyterLab with the workshop directory containing our data files
as the working directory.</p>
<p><em>Opening JupyterLab</em></p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># navigate to or start your terminal from the worskhop directory</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="ex">$</span> jupyter lab</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># you may see various status messages as it spins up jupyter server and launches your default browser</span></span></code></pre>
</div>
<p>Defining a section of code as a function in Python is done using the
<code>def</code> keyword. For example a function that takes two
arguments and returns their sum can be defined as:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="kw">def</span> add_function(a, b):</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>    result <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>z <span class="op">=</span> add_function(<span class="dv">20</span>, <span class="dv">22</span>)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="bu">print</span>(z)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="dv">42</span></span></code></pre>
</div>
<p>Key points about functions are:</p>
<ul>
<li>definition starts with <code>def</code>
</li>
<li>function body is indented</li>
<li>
<code>return</code> keyword precedes returned value</li>
</ul></section></section><section id="aio-starting-with-data"><p>Content from <a href="starting-with-data.html">Starting With Data</a></p>
<hr>
<p>Last updated on 2024-06-18 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/starting-with-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I import data in Python?</li>
<li>What is Pandas?</li>
<li>Why should I use Pandas to work with data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Navigate the workshop directory and download a dataset.</li>
<li>Explain what a library is and what libraries are used for.</li>
<li>Describe what the Python Data Analysis Library (Pandas) is.</li>
<li>Load the Python Data Analysis Library (Pandas).</li>
<li>Use <code>read_csv</code> to read tabular data into Python.</li>
<li>Describe what a DataFrame is in Python.</li>
<li>Access and summarize data stored in a DataFrame.</li>
<li>Define indexing as it relates to data structures.</li>
<li>Perform basic mathematical operations and summary statistics on data
in a Pandas DataFrame.</li>
<li>Create simple plots.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="working-with-pandas-dataframes-in-python">Working With Pandas DataFrames in Python<a class="anchor" aria-label="anchor" href="#working-with-pandas-dataframes-in-python"></a>
<a class="anchor" aria-label="anchor" href="#working-with-pandas-dataframes-in-python"></a>
</h2>
<hr class="half-width">
<p>We can automate the processes listed above using Python. It is
efficient to spend time building code to perform these tasks because
once it is built, we can use our code over and over on different
datasets that share a similar format. This makes our methods easily
reproducible. We can also share our code with colleagues so they can
replicate our analysis.</p>
<div class="section level4">
<h4 id="starting-in-the-same-spot">Starting in the same spot<a class="anchor" aria-label="anchor" href="#starting-in-the-same-spot"></a>
</h4>
<p>If you do not already have JupyterLab opened from the workshop
directroy, let’s do that now. Doing so should help us avoid path and
file name issues. At this time please navigate to the workshop directory
in your terminal.</p>
<p><em>Opening JupyterLab</em></p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># navigate to or start your terminal from the worskhop directory</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> jupyter lab</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># you may see various status messages as it spins up jupyter server </span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># and launches your default browser</span></span></code></pre>
</div>
<p>A quick aside that there are Python libraries like <a href="https://docs.python.org/3/library/os.html" class="external-link">OS Library</a> that can
work with our directory structure, however, that is not our focus
today.</p>
</div>
<div class="section level4">
<h4 id="alex-our-user-story">Alex: our user story<a class="anchor" aria-label="anchor" href="#alex-our-user-story"></a>
</h4>
<p>Alex is a researcher interested in exploring the collection of
fictional works at their university and assessing how representative it
is in relation to the student body. Alex was able to find a pre-liminary
dataset assembled by a previous researcher from which they want to
create some exploratory plots and intermediate datasets in order to
determine next steps to expand on this line of inquiry.</p>
<p>Alex could do some of this work using spreadsheet systems but this
can be time consuming to do and lead to mistakes that are hard to
detect.</p>
<p>This workshop will show how Python can be used to automate some of
the processes allowing them to be re-run in the future.</p>
</div>
<div class="section level4">
<h4 id="our-data">Our Data<a class="anchor" aria-label="anchor" href="#our-data"></a>
</h4>
<p>We will be using files from the data folder. This section will use
the <code>all_works.csv</code> file that can be found in your data
folder.</p>
<p>The dataset is stored as a comma separated (<code>.csv</code>) file,
where each row holds information for a single title, and the columns
represent diferent aspects (variables) of each entry:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="79%">
</colgroup>
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>title</td>
<td>Title of Work</td>
</tr>
<tr class="even">
<td>subjects</td>
<td>List of Subjects</td>
</tr>
<tr class="odd">
<td>mms_id</td>
<td>Metadata Management System ID</td>
</tr>
<tr class="even">
<td>author</td>
<td>Author(s) delimited with ‘;’</td>
</tr>
<tr class="odd">
<td>publication_date</td>
<td>Year of Publication</td>
</tr>
<tr class="even">
<td>publication_place</td>
<td>Place of Publication</td>
</tr>
<tr class="odd">
<td>language_code</td>
<td>Language of Text</td>
</tr>
<tr class="even">
<td>resource_type</td>
<td>Type of resource, e.g. physical, electronic</td>
</tr>
<tr class="odd">
<td>acquisition_date</td>
<td>Date of Acquisition</td>
</tr>
<tr class="even">
<td>is_dei</td>
<td>Boolean for whether work meets broadest definition of a DEI
work</td>
</tr>
<tr class="odd">
<td>checkouts</td>
<td>Count of number of times</td>
</tr>
</tbody>
</table>
<div id="semantics-of-dei" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="semantics-of-dei" class="callout-inner">
<h3 class="callout-title">Semantics of DEI<a class="anchor" aria-label="anchor" href="#semantics-of-dei"></a>
</h3>
<div class="callout-content">
<ul>
<li>Diversity, Equity and Inclusion are not concrete terms that can be
divorced from history and geography. Thus, it is incumbent on academic
researchers to define what that means in their practice.<br>
</li>
<li>Arguably, any resource is potentially useful in the pursuit of DEI
research if for no other reason as to provide contrast and foreground
for other works, so designating something a DEI resource will always be
a judgment call.<br>
</li>
<li>Here, though, the <em>is_dei</em> flag is applied to any works with
subjects deemed outside those with a male, western European lineage.
That determination is also a judgment call on multiple levels that you
may disagree with, and that is okay. Not only might you disagree with
what subjects do or do not share a male, western European lineage, but
we are also at the mercy of the cataloger wrestling with their own
biases while applying a limited scope of slowly evolving options.</li>
<li>Our flag will never be perfect, so our goal should be good enough
with the time and information we have. You can spot check the subjects
deemed <a href="../files/dei.csv">dei</a> and <a href="../files/non_dei.csv">non-dei</a>.</li>
<li>All datasets should be approached with a sceptical eye. When we are
done here, you should not only know how to leverage datasets, but
interogate and adjust them to adhere to different assumptions. Just be
sure to make those adjustments and assumptions clear to those who follow
after you.</li>
</ul>
</div>
</div>
</div>
<p>If we open the <code>all_works.csv</code> data file using a text
editor, the first few rows of our first file look like this:</p>
<pre><code>title,subjects,mms_id,author,publication_date,publication_place,language_code,resource_type,acquisition_date,is_dei,subject_count,chekcouts
"""A god of justice?"" : the problem of evil in twentieth-century Black literature","['American literature--African American authors--History and criticism', 'African Americans--Intellectual life--20th century', 'African Americans--Intellectual lif', 'American literature--African American author']",991004617919702908,"Whitted, Qiana J., 1974-",2009.0,Charlottesville,eng,Book - Physical,2016-06-26 23:51:01,True,4,
"""Baad bitches"" and sassy supermamas : Black power action films","['Blaxploitation films--United States--History and criticism', 'African American women heroes in motion pictures', 'African American women heroes in motion picture', 'Blaxploitation film', 'Blaxploitation Film']",991003607949702908,"Dunn, Stephane, 1967-",2008.0,Urbana,eng,Book - Physical,2011-12-13 03:51:20,True,5,1.0
"""Codependent lesbian space alien seeks same""","['Lesbians--Drama', 'Lesbians', 'Video recordings for the hearing impaired']",991013190057102908,"Olnek, Madeleine.; Space Aliens, LLC.",2011.0,"[New York, NY?]",eng,Projected medium - Physical,2016-11-10 07:56:09,True,3,1.0
"""Lactilla tends her fav'rite cow"" : ecocritical readings of animals and women in eighteenth-century British labouring-class women's poetry","['English poetry--Women authors--History and criticism', 'Working class writings, English--History and criticism', 'Ecofeminism in literature', 'English poetry--Women authors', 'Working class women in literature', 'Working class writings, English']",991003662979702908,"Milne, Anne.",2008.0,Lewisburg,eng,Book - Physical,2015-10-07 16:31:28,True,8,</code></pre>
</div>
<div class="section level3">
<h3 id="why-software-libraries">Why software libraries<a class="anchor" aria-label="anchor" href="#why-software-libraries"></a>
</h3>
<p>Theoretically, you could use only built in python functions to
interact directly with the text file, but you would be re-inventing the
wheel. Better to do a little research and find someone who has already
grappled with similar problems and stand on their shoulders instead.
Programming often has a mechanism to facilitate this. In python, the are
called libraries.</p>
<p>A library in Python contains a set of tools (functions) that perform
different actions. Importing a library is like getting a set of
particular tools out of a storage locker and setting them up on the
bench for use in a project. Once a library is set up, its functions can
be used or called to perform different tasks.</p>
</div>
<div class="section level3">
<h3 id="why-pandas-in-python">Why Pandas in Python<a class="anchor" aria-label="anchor" href="#why-pandas-in-python"></a>
</h3>
<p>One of the best options for working with tabular data in Python is to
use the <a href="https://pandas.pydata.org/" class="external-link">Python Data Analysis
Library</a> (a.k.a. Pandas Library). The Pandas library provides
structures to sort our data, can produce high quality plots in
conjunction with other libraries such as <a href="https://matplotlib.org/" class="external-link">matplotlib</a>, and integrates nicely
with libraries that use <a href="https://www.numpy.org/" class="external-link">NumPy</a>
(which is another common Python library) arrays.</p>
</div>
<div class="section level3">
<h3 id="loading-a-library">Loading a library<a class="anchor" aria-label="anchor" href="#loading-a-library"></a>
</h3>
<p>Python doesn’t load all of the libraries available to it by default.
We have to add an <code>import</code> statement to our code in order to
use library functions required for our project. To import a library, we
use the syntax <code>import libraryName</code>, where
<code>libraryName</code> represents the name of the specific library we
want to use. Note that the <code>import</code> command calls a library
that has been installed previously in our system. If we use the
<code>import</code> command to call for a library that does not exist in
our local system, the command will throw and error when executed. In
this case, you can use <code>pip</code> command in another terminal
window to install the missing libraries. <a href="https://github.com/resbaz/Intro_Python_Nov2017/blob/master/Python_Installation.md" class="external-link">See
here for details</a> on how to do this.</p>
<p>Moreover, if we want to give the library a nickname to shorten the
command, we can add <code>as nickNameHere</code>. An example of
importing the pandas library using the common nickname <code>pd</code>
is:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>Each time we call a function that’s in a library, we use the syntax
<code>LibraryName.FunctionName</code>. Adding the library name with a
<code>.</code> before the function name tells Python where to find the
function. In the example above, we have imported Pandas as
<code>pd</code>. This means we don’t have to type out
<code>pandas</code> each time we call a Pandas function.</p>
</div>
</section><section><h2 class="section-heading" id="reading-csv-data-using-pandas">Reading CSV Data Using Pandas<a class="anchor" aria-label="anchor" href="#reading-csv-data-using-pandas"></a>
<a class="anchor" aria-label="anchor" href="#reading-csv-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We will begin by locating and reading in a data which in CSV format.
We can use Pandas’ <code>read_csv</code> function to pull either a local
(a file in our machine) or a remote (one that is available for
downloading from the web) file into a Pandas table or <a href="https://pandas.pydata.org/pandas-docs/stable/dsintro.html#dataframe" class="external-link">DataFrame</a>.</p>
<p>In order to read data in, we need to know where the data is stored on
our computer or its URL address if the file is available on the web.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># note that pd.read_csv is used because we imported pandas as pd</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co"># note that this assumes that the data file is in the same location</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># as the Jupyter notebook to simplify pathing</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>pd.read_csv(<span class="st">"all_works.csv"</span>)</span></code></pre>
</div>
<div class="section level3">
<h3 id="so-whats-a-dataframe">So What’s a DataFrame?<a class="anchor" aria-label="anchor" href="#so-whats-a-dataframe"></a>
</h3>
<p>A DataFrame is a 2-dimensional data structure that can store data of
different types (including characters, integers, floating point values,
factors and more) in columns. It is similar to a spreadsheet or a
<code>data.frame</code> in R. A DataFrame always has an index (0-based
integers by default). An index refers to the position of an element in
the data structure.</p>
<p>The above command yields the <strong>output</strong> similar to
below, but formatted differently</p>
<pre><code>                                                   title                                           subjects  ...  is_dei checkouts
0      "A god of justice?" : the problem of evil in t...  ['American literature--African American author...  ...    True         0
1      "Baad bitches" and sassy supermamas : Black po...  ['Blaxploitation films--United States--History...  ...    True         1
2           "Codependent lesbian space alien seeks same"  ['Lesbians--Drama', 'Lesbians', 'Video recordi...  ...    True         1
3      "Lactilla tends her fav'rite cow" : ecocritica...  ['English poetry--Women authors--History and c...  ...    True         0
4      "The useless mouths", and other literary writings  ['French drama--20th century--Translations int...  ...    True         1
...                                                  ...                                                ...  ...     ...       ...
14227  ¡Ban c/s this! : the BSP anthology of Xican@ l...  ["Littérature américaine--Auteurs américain...  ...   False         0
14228  ¡Muy pop! : conversations on Latino popular cu...  ['Popular culture--United States', "Littératu...  ...   False         1
14229  ¡Viva la historieta! : Mexican comics, NAFTA, ...  ['Mondialisation dans la littérature', "Mondi...  ...   False         0
14230                 Đời về cơ bản là buồn cười  ['Life--Comic books, strips, etc', 'Life', 'Co...  ...   False         3
14231  Đường vào văn chương : phê bình lý trí ...  ['Literature, Modern--History and criticism--T...  ...   False         0

[14232 rows x 11 columns]</code></pre>
<p>We can see that there were 14232 rows parsed. Each row has 11
columns. The first column displayed is the <strong>index</strong> of the
DataFrame. The index is used to identify the position of the data, but
it is not an actual column of the DataFrame. It looks like the
<code>read_csv</code> function in Pandas read our file properly.
However, we haven’t saved any data to memory so we can not work with it
yet. We need to assign the DataFrame to a variable so we can call and
use the data. Remember that a variable is a name given to a value, such
as <code>x</code>, or <code>data</code>. We can create a new object with
a variable name by assigning a value to it using <code>=</code>.</p>
<p>Let’s call the imported data <code>works_df</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>works_df <span class="op">=</span> pd.read_csv(<span class="st">"all_works.csv"</span>)</span></code></pre>
</div>
<p>Notice that when you assign the imported DataFrame to a variable,
Python does not produce any output on the screen. We can print the value
of the <code>works_df</code> object by typing its name into the cell and
running it. If you were doing this in a script file, you would need to
use <code>print(works_df)</code>. Not needing to do so here is another
convenience feature of Jupyter.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>works_df</span></code></pre>
</div>
<p>which prints contents like above</p>
</div>
<div class="section level3">
<h3 id="exploring-our-data">Exploring our Data<a class="anchor" aria-label="anchor" href="#exploring-our-data"></a>
</h3>
<p>We can use attributes and methods provided by the DataFrame object to
summarize and access the data stored in it.</p>
<p>Attributes are called by using the syntax
<code>df_object.attribute</code>. For example, we can use the
<em>dtypes</em> attribute of the DataFrame to return a Series object of
the dataypes for each column in the DataFrame.</p>
<pre><code><span><span class="va">works_df.dtypes</span></span></code></pre>
<p>which returns output similar to:</p>
<pre><code>title                object
subjects             object
mms_id                int64
author               object
publication_date      int64
publication_place    object
language_code        object
resource_type        object
acquisition_date     object
is_dei                 bool
checkouts             int64
dtype: object</code></pre>
<p><code>int64</code> represents numeric integer values -
<code>int64</code> cells cannot store decimals. <code>object</code>
represents strings (letters and numbers). <code>float64</code>
represents numbers with decimals.</p>
<p>Methods are called by using the syntax
<code>df_object.method()</code>. Note the inclusion of open brackets at
the end of the method. Python treats methods as
<strong>functions</strong> associated with a dataframe rather than just
a property of the object as with attributes. Similarly to functions,
methods can include optional parameters inside the brackets to change
their default behaviour.</p>
<p>As an example, <code>works_df.head()</code> gets the first few rows
in the DataFrame <code>works_df</code> using <strong>the
<code>head()</code> method</strong>. With a method, we can supply extra
information within the open brackets to control its behaviour,
e.g. <code>works_df.head(25)</code>.</p>
<p>Let’s try out a few of the common DataFrame methods and
attributes.</p>
<div id="challenge---dataframes" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---dataframes" class="callout-inner">
<h3 class="callout-title">Challenge - DataFrames<a class="anchor" aria-label="anchor" href="#challenge---dataframes"></a>
</h3>
<div class="callout-content">
<p>Using our DataFrame <code>works_df</code>, try out the attributes
&amp; methods below to see what they return.</p>
<ol style="list-style-type: decimal">
<li><p><code>works_df.columns</code></p></li>
<li><p><code>works_df.shape</code> Take note of the output of
<code>shape</code> - what format does it return the shape of the
DataFrame in?</p></li>
</ol>
<p>HINT: <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" class="external-link">More
on tuples, here</a>.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><code>works_df.head()</code> Also, what does
<code>works_df.head(15)</code> do?</p></li>
<li><p><code>works_df.tail()</code></p></li>
<li><p><code>works_df.info()</code></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p><code>works_df.columns</code> return list of column as a data
type <em>pandas.core.indexes.base.Index</em></p></li>
<li><p><code>works_df.shape</code>. Take note of the output of the shape
method. What format does it return the shape of the DataFrame
in?</p></li>
</ol>
<p><code>type(works_df.shape)</code> -&gt; <code>Tuple</code>, (rows,
columns), i.e. standard row-first Python format</p>
<ol start="3" style="list-style-type: decimal">
<li>
<code>works_df.head()</code>. Also, what does
<code>works_df.head(15)</code> do?</li>
</ol>
<p>Show first <code>N</code> lines</p>
<ol start="4" style="list-style-type: decimal">
<li><code>works_df.tail()</code></li>
</ol>
<p>Show last <code>N</code> lines</p>
<ol start="5" style="list-style-type: decimal">
<li>
<code>works_df.info()</code> returns a table with wealth of
information about number of colums, datatypes, missing values, memory
usage.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="summary-statistics-groups-in-pandas">Summary Statistics &amp; Groups in Pandas<a class="anchor" aria-label="anchor" href="#summary-statistics-groups-in-pandas"></a>
</h3>
<p>We often want to calculate summary statistics for our data. This can
be useful even at the exploratory phase as it can help you understand
the ranges of your data and detect possible outliers.</p>
<p>We can calculate basic statistics for all records in a single column
using the syntax below:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].describe()</span></code></pre>
</div>
<p>gives <strong>output</strong></p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>count    <span class="fl">14232.000000</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>mean         <span class="fl">0.526349</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>std          <span class="fl">1.432189</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="bu">min</span>          <span class="fl">0.000000</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="dv">25</span><span class="op">%</span>          <span class="fl">0.000000</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="dv">50</span><span class="op">%</span>          <span class="fl">0.000000</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="dv">75</span><span class="op">%</span>          <span class="fl">1.000000</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="bu">max</span>         <span class="fl">43.000000</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>Name: checkouts, dtype: float64</span></code></pre>
</div>
<p>We can also extract specific metrics for one or various columns if we
wish:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].<span class="bu">min</span>()</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].<span class="bu">max</span>()</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].mean()</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].std()</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>].count()</span></code></pre>
</div>
<p>But if we want to summarize by one or more variables, for example
checkouts by language_code, we can use the <strong><code>.groupby</code>
method</strong>. When executed, this method creates a DataFrameGroupBy
object containing a subset of the original DataFrame. Once we’ve created
it, we can quickly calculate summary statistics by a group of our
choice. For example the following code will group our data by
language_code.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Group data by status</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>grouped_data <span class="op">=</span> works_df.groupby(<span class="st">'language_code'</span>)</span></code></pre>
</div>
<p>If we execute the <strong>pandas function
<code>describe</code></strong> on this new object we will obtain
descriptive stats for all the numerical columns in <code>works_df</code>
grouped by the different cities available in the
<code>publication_place</code> column of the DataFrame.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># summary statistics for all numeric columns by place</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>grouped_data.describe()</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># provide the mean for each numeric column by place</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>grouped_data.mean()</span></code></pre>
</div>
<p><code>grouped_data.mean(numeric_only=True)</code>
<strong>OUTPUT:</strong></p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>	mms_id	publication_date	is_dei	checkouts</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>language_code				</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>ara	<span class="fl">9.910032e+17</span>	<span class="fl">2009.000000</span>	<span class="fl">0.400000</span>	<span class="fl">0.000000</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>bos	<span class="fl">9.910132e+17</span>	<span class="fl">2018.000000</span>	<span class="fl">0.500000</span>	<span class="fl">0.000000</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>cat	<span class="fl">9.910131e+17</span>	<span class="fl">2011.000000</span>	<span class="fl">0.500000</span>	<span class="fl">0.000000</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>chi	<span class="fl">9.910073e+17</span>	<span class="fl">2011.400000</span>	<span class="fl">0.500000</span>	<span class="fl">0.700000</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># Truncated for brevity</span></span></code></pre>
</div>
<p>The <code>groupby</code> command is powerful in that it allows us to
quickly generate summary stats, but how do you know what columns will
make good group by candidates.</p>
<p>Let’s use the publication locations as an example by finding out how
many unique values are in that column. DataFrames and Series object
often share methods allowing for two different approaches. One method
calls <code>pd.unique</code> function directly off the dataframe and
passes in the column of intrest. In the other, we can a method directly
off the column <code>works_df['publication_place'].unique()</code>. The
output is identical listing the unique values in the
<code>publication_place</code> column.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>pd.unique(works_df[<span class="st">'publication_place'</span>])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>works_df[<span class="st">'publication_place'</span>].unique()</span></code></pre>
</div>
<p>either <strong>returns</strong>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>array([<span class="st">'Charlottesville'</span>, <span class="st">'Urbana'</span>, <span class="st">'[New York, NY?]'</span>, ...,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>       <span class="st">'Cambridge [UK] ; Medford'</span>, <span class="st">'Arles'</span>, <span class="st">'[London]:'</span>], dtype<span class="op">=</span><span class="bu">object</span>)</span></code></pre>
</div>
<div id="challenge---statistics" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---statistics" class="callout-inner">
<h3 class="callout-title">Challenge - Statistics<a class="anchor" aria-label="anchor" href="#challenge---statistics"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a list of unique publicaton years found in the data. Call
it <code>years</code>. How many unique years are there in the
data?</p></li>
<li><p>What is the difference between <code>len(years)</code> and
<code>works_df['publication_date'].nunique()</code>?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Create a list of unique locations found in the index data. Call it
<code>places</code>. How many unique location are there in the
data?</li>
</ol>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>years <span class="op">=</span> pd.unique(works_df[<span class="st">"publication_date"</span>])</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="bu">len</span>(years)</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>What is the difference between <code>len(years)</code> and
<code>works_df["publication_date"].nunique()</code>?</li>
</ol>
<p>Both do result in the same output, making it alternative ways of
getting the unique values. <code>nunique</code> combines the count and
unique value extraction.</p>
</div>
</div>
</div>
</div>
<div id="challenge---summary-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---summary-data" class="callout-inner">
<h3 class="callout-title">Challenge - Summary Data<a class="anchor" aria-label="anchor" href="#challenge---summary-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create your own groupy object based on publicatin_place and take the
mean of checkouts.</li>
<li>What is the mean number of checkout for works published in
<code>[Washington, D.C.]</code>.</li>
<li>What does the summary stats uncover about the quality of data in the
publication_place column?</li>
<li>What happens when you group by two columns using the following
syntax and then grab mean values:</li>
</ol>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>grouped_data2 <span class="op">=</span> all_works_df.groupby([<span class="st">'resource_type'</span>, <span class="st">'language_code'</span>])</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>mean_values_by_type_and_language <span class="op">=</span> grouped_data2.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>mean_values_by_type_and_language</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>grouped_data <span class="op">=</span> all_works_df.groupby(<span class="st">'publication_place'</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>means_by_publication_place <span class="op">=</span> grouped_data.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>means_by_publication_place[<span class="st">'checkouts'</span>]</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>We can see in the list that is <em>0.000000</em>.</li>
<li>We can see that the entries vary in how they are formatted. For a
real analysis, you would likley want to clean this up before proceeding.
We can browse the full list using code like the following to
confirm:</li>
</ol>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="cf">for</span> place <span class="kw">in</span> <span class="bu">sorted</span>(all_works_df[<span class="st">'publication_place'</span>].unique()):</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>    <span class="bu">print</span>(place)</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>This code will create a GroupBy object grouped by both resource_type
and language_code and then calculate the mean of all numerical columns
within each group. This is useful for seeing trends across different
types of resources and languages, potentially revealing interactions
between these categories.</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="quickly-creating-summary-counts-in-pandas">Quickly Creating Summary Counts in Pandas<a class="anchor" aria-label="anchor" href="#quickly-creating-summary-counts-in-pandas"></a>
</h3>
<p>Let’s next count the number of publications for each author(s). We
can do this in a few ways, but we’ll use <code>groupby</code> combined
with <strong>a <code>count()</code> method</strong>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># count the number of texts by authors / groups of authors</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>author_counts <span class="op">=</span> works_df.groupby(<span class="st">'author'</span>)[<span class="st">'mms_id'</span>].count()</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>author_counts</span></code></pre>
</div>
<p>Or, we can also count just the rows that have the a specifig author
like “Abate, Michelle Ann, 1975-”:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>author_counts <span class="op">=</span> works_df.groupby(<span class="st">'author'</span>)[<span class="st">'mms_id'</span>].count()[<span class="st">'Abate, Michelle Ann, 1975-'</span>]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>author_counts</span></code></pre>
</div>
<p>How does the code work?
<code>works_df.groupby('author')['mms_id'].count()</code> actually
returns a series where <em>author</em> is the index. We then filter by
that specific index.</p>
<div id="just-because-you-can-doesnt-mean-you-should" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="just-because-you-can-doesnt-mean-you-should" class="callout-inner">
<h3 class="callout-title">Just because you can doesn’t mean you should<a class="anchor" aria-label="anchor" href="#just-because-you-can-doesnt-mean-you-should"></a>
</h3>
<div class="callout-content">
<p>Many of our works have groups of authors, and they are all contained
in a single cell. This makes some questions easier to ask and some
harder. It is actually non-trivial to get a count of all of “Abate,
Michelle Ann, 1975-” works since she may be listed among other author
groups. Thus grouping by author and filtering on this key given the
current data configuration may not be telling us what we thought it was.
Thus it is important to know your data well and format it and reformat
it to meet your analysis needs. You need to stay vigilant and check your
understanding. Python won’t stop you from doing a poor analysis very
efficiently.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="math-operations">Math Operations<a class="anchor" aria-label="anchor" href="#math-operations"></a>
</h3>
<p>If we wanted to, we could perform math on an entire numerical column
of our data. To demonstrate this, let’s add another column that shows
the percentage of total checkouts for each work.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>all_checkouts <span class="op">=</span> works_df.checkouts.<span class="bu">sum</span>()</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co"># because "checkout_percentage" is not in our columns index, pandas add is as a new column.</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>works_df[<span class="st">"checkout_percentage"</span>] <span class="op">=</span> (works_df.checkouts <span class="op">/</span> all_checkouts) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>works_df.checkout_percentage</span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="quick-easy-plotting-data-using-pandas">Quick &amp; Easy Plotting Data Using Pandas<a class="anchor" aria-label="anchor" href="#quick-easy-plotting-data-using-pandas"></a>
<a class="anchor" aria-label="anchor" href="#quick-easy-plotting-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We will looks at plotting more in depth later, but we can rapidly
plot our summary stats using Pandas.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># group data</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>is_dei_count <span class="op">=</span> works_df.groupby(<span class="st">"is_dei"</span>)[<span class="st">"mms_id"</span>].count() </span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co"># set equal to variable so we can set additional parameters</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>plot <span class="op">=</span> is_dei_count.plot(kind<span class="op">=</span><span class="st">"bar"</span>, title<span class="op">=</span><span class="st">"Checkout by DEI Status"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#lablel the y-axis</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>plot.set_ylabel(<span class="st">"Checkouts"</span>)</span></code></pre>
</div>
<p>What does this graph show? Let’s step through</p>
<ul>
<li><p><code>works_df.groupby("is_dei")</code> : This groups the works
by the boolean flag.</p></li>
<li><p><code>works_df.groupby("is_dei")["mms_id"]</code> : This chooses
a single column to count, rather than counting all columns since we only
want one number to plot. You could effectively pick any column.</p></li>
<li><p><code>works_df.groupby("is_dei")["mms_id"].count()</code> : this
counts the instances, i.e. how many works per given boolean
value?</p></li>
<li><p><code>plot = is_dei_count.plot(kind="bar",title="Checkout by DEI Status")</code>
: this plots a bar chart with the boolean flag on x axis and count on
the y axis, sets title.</p></li>
<li><p><code>plot.set_ylabel("Checkouts")</code> : this labels the
y-axis</p></li>
</ul>
<div id="challenge4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge4"></a>
</h3>
<div class="callout-content">
<p>Summary Plotting Challenge</p>
<p>Create a stacked bar plot, showing the checkouts, per language_code,
with the is_dei stacked on top of each other for the 10 languages with
the most checkouts. Drop any records where is_dei True column is NAN.
The language_code should go on the X axis, and the checkouts on the Y
axis. Some tips are below to help you solve this challenge:</p>
<ul>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/visualization.html#basic-plotting-plot" class="external-link">For
more on Pandas plots, visit this link.</a></li>
<li>You can use the code that follows to create a stacked bar plot but
the data to stack need to be in individual columns. Here’s a simple
example with some data where ‘a’, ‘b’, and ‘c’ are the groups, and ‘one’
and ‘two’ are the subgroups.</li>
</ul>
<pre><code>d = {'one' : pd.Series([1., 2., 3.], index=['a', 'b', 'c']),'two' : pd.Series([1., 2., 3., 4.], index=['a', 'b', 'c', 'd'])}
pd.DataFrame(d)</code></pre>
<p>shows the following data</p>
<pre><code>      one  two
  a    1    1
  b    2    2
  c    3    3
  d  NaN    4</code></pre>
<p>We can plot the above with</p>
<pre><code><span><span class="co"># plot stacked data so columns 'one' and 'two' are stacked</span></span>
<span><span class="va">my_df</span> <span class="op">=</span> <span class="fu">pd.DataFrame</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="fu">my_df.plot</span><span class="op">(</span>kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">"The title of my graph"</span><span class="op">)</span></span></code></pre>
<figure><img src="../fig/stackedBar1.png" alt="Stacked Bar Plot" class="figure mx-auto d-block"><div class="figcaption">Stacked Bar Plot</div>
</figure><ul>
<li>You can use the <code>.unstack()</code> method to transform grouped
data into columns for each plotting. Try running <code>.unstack()</code>
on some DataFrames above and see what it yields.</li>
</ul>
<p>Start by transforming the grouped data into an unstacked layout, then
create a stacked plot.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>First we group data by language_code and then by is_dei.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Step 1: Aggregate total checkouts per language_code regardless of is_dei</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>total_checkouts_per_language <span class="op">=</span> works_df.groupby(<span class="st">'language_code'</span>)[<span class="st">'checkouts'</span>].<span class="bu">sum</span>()</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co"># Step 2: Sort these totals and get the top 10 language codes</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>top_10_languages <span class="op">=</span> total_checkouts_per_language.sort_values(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>).index</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co"># Step 3: Filter the original DataFrame to include only these top 10 languages</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>filtered_df <span class="op">=</span> works_df[works_df[<span class="st">'language_code'</span>].isin(top_10_languages)]</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co"># Step 4: Group by both language_code and is_dei, and sum the checkouts</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>grouping <span class="op">=</span> filtered_df.groupby([<span class="st">'language_code'</span>, <span class="st">'is_dei'</span>])[<span class="st">'checkouts'</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
<p>The last lines above calculates the sum of checkouts, for each
language_code further broken down by DEI boolean flag, as a table and
keeps only the top 10 most checked out items.</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>language_code  is_dei
chi            False        7
               True         7
eng            False     4441
               True      2530
fre            False       70
               True        62
ger            False        7
               True         6
heb            False        6
               True         6
ita            False       21
               True         2
jpn            False       20
               True        20
kor            False        3
               True         3
per            False       27
               True        26
spa            False       95
               True        92
Name: checkouts, dtype: int64</code></pre>
</div>
<p>After that, we use the <code>.unstack()</code> function on our
grouped data to figure out the total contribution of DEI verse non-DEI
for each language_code, and then plot the data.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Step 5: Unstack the is_dei level for plotting</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>grouping_unstacked <span class="op">=</span> grouping.unstack()</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># Plot the data</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>plot <span class="op">=</span> grouping_unstacked.plot(kind<span class="op">=</span><span class="st">"bar"</span>, stacked<span class="op">=</span><span class="va">True</span>, title<span class="op">=</span><span class="st">"DEI Checkouts By Language"</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>), logy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>plot.set_ylabel(<span class="st">"Checkouts"</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-index-slice-subset"><p>Content from <a href="index-slice-subset.html">Indexing, Slicing and Subsetting DataFrames in Python</a></p>
<hr>
<p>Last updated on 2024-06-18 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/index-slice-subset.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I access specific data within my data set?</li>
<li>How can Python and Pandas help me to analyse my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe what 0-based indexing is.</li>
<li>Manipulate and extract data using column headings and index
locations.</li>
<li>Employ slicing to select sets of data from a DataFrame.</li>
<li>Employ label and integer-based indexing to select ranges of data in
a dataframe.</li>
<li>Reassign values within subsets of a DataFrame.</li>
<li>Create a copy of a DataFrame.</li>
<li>Query /select a subset of data using a set of criteria using the
following operators: =, !=, &gt;, &lt;, &gt;=, &lt;=.</li>
<li>Locate subsets of data using masks.</li>
<li>Describe BOOLEAN objects in Python and manipulate data using
BOOLEANs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In lesson 01, we read a CSV into a Python pandas DataFrame. We
learned:</p>
<ul>
<li>how to save the DataFrame to a named object,</li>
<li>how to perform basic math on the data,</li>
<li>how to calculate summary statistics, and</li>
<li>how to create plots of the data.</li>
</ul>
<p>In this lesson, we will explore <strong>ways to access different
parts of the data</strong> using:</p>
<ul>
<li>indexing,</li>
<li>slicing, and</li>
<li>subsetting.</li>
</ul>
<section><h2 class="section-heading" id="loading-our-data">Loading our data<a class="anchor" aria-label="anchor" href="#loading-our-data"></a>
<a class="anchor" aria-label="anchor" href="#loading-our-data"></a>
</h2>
<hr class="half-width">
<p>We will continue to use the works dataset that we worked with in the
last lesson. Let’s reopen and read in the data again:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Make sure pandas is loaded</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># read in the survey csv</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>works_df <span class="op">=</span> pd.read_csv(<span class="st">"all_works.csv"</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="indexing-and-slicing-in-python">Indexing and Slicing in Python<a class="anchor" aria-label="anchor" href="#indexing-and-slicing-in-python"></a>
<a class="anchor" aria-label="anchor" href="#indexing-and-slicing-in-python"></a>
</h2>
<hr class="half-width">
<p>We often want to work with subsets of a <strong>DataFrame</strong>
object. There are different ways to accomplish this including: using
labels (column headings), numeric ranges, or specific x,y index
locations.</p>
</section><section><h2 class="section-heading" id="selecting-data-using-labels-column-headings">Selecting data using Labels (Column Headings)<a class="anchor" aria-label="anchor" href="#selecting-data-using-labels-column-headings"></a>
<a class="anchor" aria-label="anchor" href="#selecting-data-using-labels-column-headings"></a>
</h2>
<hr class="half-width">
<p>We use square brackets <code>[]</code> to select a subset of an
Python object. As we saw in the previous espisode, we can select all
data from the column named <code>checkouts</code> from the
<code>works_df</code> DataFrame by name. There are two ways to do
this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Method 1: select a 'subset' of the data using the column name</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>works_df[<span class="st">'checkouts'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Method 2: use the column name as an 'attribute'; gives the same output</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>works_df.checkouts</span></code></pre>
</div>
<p>We can also create a new object that contains only the data within
the <code>checkouts</code> column as follows:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># creates an object, checkouts_series, that only contains the `checkouts` column</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>checkouts_series <span class="op">=</span> works_df[<span class="st">'checkouts'</span>]</span></code></pre>
</div>
<p>We can pass a list of column names too, as an index to select columns
in that order. This is useful when we need to reorganize our data.</p>
<p><strong>NOTE:</strong> If a column name is not contained in the
DataFrame, an exception (error) will be raised.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># select the title and checkouts columns from the DataFrame</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>works_df[[<span class="st">'title'</span>, <span class="st">'checkouts'</span>]]</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># what happens when you flip the order?</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>works_df[[<span class="st">'checkouts'</span>, <span class="st">'title'</span>]]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#what happens if you ask for a column that doesn't exist?</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>works_df[<span class="st">'Texts'</span>]</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="extracting-range-based-subsets-slicing">Extracting Range based Subsets: Slicing<a class="anchor" aria-label="anchor" href="#extracting-range-based-subsets-slicing"></a>
<a class="anchor" aria-label="anchor" href="#extracting-range-based-subsets-slicing"></a>
</h2>
<hr class="half-width">
<p><strong>REMINDER</strong>: Python Uses 0-based Indexing</p>
<p>Let’s remind ourselves that Python uses 0-based indexing. This means
that the first element in an object is located at position 0. This is
different from other tools like R and Matlab that index elements within
objects starting at 1.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Create a list of numbers:</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span></code></pre>
</div>
<p><img src="../fig/slicing-indexing.svg" alt="indexing diagram" class="figure"><img src="../fig/slicing-slicing.svg" alt="slicing diagram" class="figure"></p>
<div id="challenge---extracting-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---extracting-data" class="callout-inner">
<h3 class="callout-title">Challenge - Extracting data<a class="anchor" aria-label="anchor" href="#challenge---extracting-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What value does the code below return?</li>
</ol>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>a[<span class="dv">0</span>]</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>How about this:</li>
</ol>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>a[<span class="dv">5</span>]</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li><p>In the example above, calling <code>a[5]</code> returns an error.
Why is that?</p></li>
<li><p>What about?</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>a[<span class="bu">len</span>(a)]</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ul>
<li>
<p>What value does the code below return? <code>a[0]</code></p>
<p><code>1</code>, as Python starts with element 0 (for Matlab users:
this is different!)</p>
</li>
<li>
<p>How about this: <code>a[5]</code></p>
<p><code>IndexError</code></p>
</li>
<li>
<p>In the example above, calling <code>a[5]</code> returns an error.
Why is that?</p>
<p>The list has no element with index 5 (going from 0 till 4).</p>
</li>
<li>
<p>What about? <code>a[len(a)]</code></p>
<p><code>IndexError</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="slicing-subsets-of-rows-in-python">Slicing Subsets of Rows in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-in-python"></a>
<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-in-python"></a>
</h2>
<hr class="half-width">
<p>Slicing using the <code>[]</code> operator selects a set of rows
and/or columns from a DataFrame. To slice out a set of rows, you use the
following syntax: <code>data[start:stop]</code>. When slicing in pandas
the start bound is included in the output. The stop bound should be set
to one step BEYOND the row you want to select. So if you want to select
rows 0, 1 and 2 your code would look like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># select rows 0, 1, 2 (row 3 is not selected)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>works_df[<span class="dv">0</span>:<span class="dv">3</span>]</span></code></pre>
</div>
<p>The stop bound in Python is different from what you might be used to
in languages like Matlab and R.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># select the first 5 rows (rows 0, 1, 2, 3, 4)</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>works_df[:<span class="dv">5</span>]</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># select the last element in the list</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># (the slice starts at the last element,</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># and ends at the end of the list)</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>works_df[<span class="op">-</span><span class="dv">1</span>:]</span></code></pre>
</div>
<p>We can also reassign values within subsets of our DataFrame.</p>
<p>But before we do that, let’s look at the difference between the
concept of copying objects and the concept of referencing objects in
Python.</p>
</section><section><h2 class="section-heading" id="copying-objects-vs-referencing-objects-in-python">Copying Objects vs Referencing Objects in Python<a class="anchor" aria-label="anchor" href="#copying-objects-vs-referencing-objects-in-python"></a>
<a class="anchor" aria-label="anchor" href="#copying-objects-vs-referencing-objects-in-python"></a>
</h2>
<hr class="half-width">
<p>Let’s start with an example:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># using the 'copy() method'</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>true_copy_works_df <span class="op">=</span> works_df.copy()</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># using '=' operator</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>ref_works_df <span class="op">=</span> works_df</span></code></pre>
</div>
<p>You might think that the code <code>ref_works_df = works_df</code>
creates a fresh distinct copy of the <code>works_df</code> DataFrame
object. However, using the <code>=</code> operator in the simple
statement <code>y = x</code> does <strong>not</strong> create a copy of
our DataFrame. Instead, <code>y = x</code> creates a new variable
<code>y</code> that references the <strong>same</strong> object that
<code>x</code> refers to. To state this another way, there is only
<strong>one</strong> object (the DataFrame), and both <code>x</code> and
<code>y</code> refer to it.</p>
<p>In contrast, the <code>copy()</code> method for a DataFrame creates a
true copy of the DataFrame.</p>
<p>Let’s look at what happens when we reassign the values within a
subset of the DataFrame that references another DataFrame object:</p>
<pre><code> # Assign the value `0` to the first three rows of data in the DataFrame
 ref_works_df[0:3] = 0
 ```

Let's try the following code:

 ```
# ref_works_df was created using the '=' operator
 ref_works_df.head()

 # works_df is the original dataframe
 works_df.head()</code></pre>
<p>What is the difference between these two dataframes?</p>
<p>When we assigned the first 3 columns the value of <code>0</code>
using the <code>ref_works_df</code> DataFrame, the <code>works_df</code>
DataFrame is modified too. Remember we created the reference
<code>ref_survey_df</code> object above when we did
<code>ref_survey_df = works_df</code>. Remember <code>works_df</code>
and <code>ref_works_df</code> refer to the same exact DataFrame object.
If either one changes the object, the other will see the same changes to
the reference object.</p>
<p><strong>To review and recap</strong>:</p>
<ul>
<li>
<p><strong>Copy</strong> uses the dataframe’s <code>copy()</code>
method</p>
<pre><code><span><span class="va">true_copy_works_df</span> <span class="op">=</span> <span class="fu">works_df.copy</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</li>
<li>
<p>A <strong>Reference</strong> is created using the <code>=</code>
operator</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>ref_works_df <span class="op">=</span> works_df</span></code></pre>
</div>
</li>
</ul>
<p>Okay, that’s enough of that. Let’s create a brand new clean dataframe
from the original data CSV file.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>works_df <span class="op">=</span> pd.read_csv(<span class="st">"all_works.csv"</span>)</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="slicing-subsets-of-rows-and-columns-in-python">Slicing Subsets of Rows and Columns in Python<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-and-columns-in-python"></a>
<a class="anchor" aria-label="anchor" href="#slicing-subsets-of-rows-and-columns-in-python"></a>
</h2>
<hr class="half-width">
<p>We can select specific ranges of our data in both the row and column
directions using either label or integer-based indexing. Columns can be
selected either by their name, or by the index of their location in the
dataframe. Rows can only be selected by their index, but the index is
not necessarily an integer as it is by default.</p>
<ul>
<li>
<code>loc</code> is primarily <em>label</em> based indexing.
<em>Integers</em> may be used but they are interpreted as a
<em>label</em>.</li>
<li>
<code>iloc</code> is primarily <em>integer</em> based indexing</li>
</ul>
<div class="section level3">
<h3 id="iloc">iloc<a class="anchor" aria-label="anchor" href="#iloc"></a>
</h3>
<p>To select a subset of rows <strong>and</strong> columns from our
DataFrame, we can use the <code>iloc</code> method. For example, we can
select subjects, mms_id, and author (columns 2, 3 and 4 if we start
counting at 1), like this:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># iloc[row slicing, column slicing]</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>works_df.iloc[<span class="dv">0</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]</span></code></pre>
</div>
<p>which gives the <strong>output</strong></p>
<pre><code>	                                      subjects	              mms_id	                 author
0	['American literature--African American author...	991004617919702908	Whitted, Qiana J., 1974-
1	['Blaxploitation films--United States--History...	991003607949702908	Dunn, Stephane, 1967-
2	['Lesbians--Drama', 'Lesbians', 'Video recordi...	991013190057102908	Olnek, Madeleine.; Space Aliens, LLC.</code></pre>
<p>Notice that we asked for a slice from 0:3. This yielded 3 rows of
data. When you ask for 0:3, you are actually telling Python to start at
index 0 and select rows 0, 1, 2 <strong>up to but not including
3</strong>.</p>
<p>We can also select a specific data value using a row and column
location within the DataFrame and <code>iloc</code> indexing:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Syntax for iloc indexing to finding a specific data element</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>dat.iloc[row, column]</span></code></pre>
</div>
<p>In this <code>iloc</code> example,</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>works_df.iloc[<span class="dv">2</span>, <span class="dv">6</span>]</span></code></pre>
</div>
<p>gives the <strong>output</strong></p>
<pre><code><span><span class="st">'eng'</span></span></code></pre>
<p>Remember that Python indexing begins at 0. So, the index location [2,
6] selects the element that is 3 rows down and 7 columns over in the
DataFrame.</p>
</div>
<div class="section level3">
<h3 id="loc">loc<a class="anchor" aria-label="anchor" href="#loc"></a>
</h3>
<p>Let’s explore ways to index and select subsets of data with loc:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># select all columns for rows of index values 0 and 10</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>works_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>], :]</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># what does this do?</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>works_df.loc[<span class="dv">0</span>, [<span class="st">'author'</span>, <span class="st">'title'</span>, <span class="st">'checkouts'</span>]]</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># What happens when you type the code below?</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>works_df.loc[[<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">149</span>], :]</span></code></pre>
</div>
<p><strong>NOTE</strong>: Labels must be found in the DataFrame or you
will get a <code>KeyError</code>.</p>
<p>Indexing by labels <code>loc</code> differs from indexing by integers
<code>iloc</code>. With <code>iloc</code>, the start bound and the stop
bound are <strong>inclusive</strong>. When using <code>loc</code>
instead, integers <em>can</em> also be used, but the integers refer to
the index label and not the position. For example, using
<code>loc</code> and select 1:4 will get a different result than using
<code>iloc</code> to select rows 1:4.</p>
<div id="challenge---range" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---range" class="callout-inner">
<h3 class="callout-title">Challenge - Range<a class="anchor" aria-label="anchor" href="#challenge---range"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Given the three range indicies below, what do you expect to get
back? Does it match what you actually get back?</li>
</ol>
<ul>
<li><code>works_df[0:1]</code></li>
<li><code>works_df[:4]</code></li>
<li><code>works_df[:-1]</code></li>
</ul>
<p><em>Suggestion</em>: You can also select every Nth row:
<code>works_df[1:10:2]</code>. So, how to interpret
<code>works_df[::-1]</code>?</p>
<ul>
<li>What is the difference between <code>works_df.iloc[0:4, 1:4]</code>
and <code>works_df.loc[0:4, 1:4]</code>?</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>Checks the position, or the name. The second is like it would be in a
dictionary, asking for the key-names. Column names 1:4 do not exist,
resulting in an error. Check also the difference between
<code>works_df.loc[0:4]</code> and <code>works_df.iloc[0:4]</code></p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="subsetting-data-using-criteria">Subsetting Data using Criteria<a class="anchor" aria-label="anchor" href="#subsetting-data-using-criteria"></a>
<a class="anchor" aria-label="anchor" href="#subsetting-data-using-criteria"></a>
</h2>
<hr class="half-width">
<p>A <strong>mask</strong> can be useful to locate where a particular
subset of values exist or don’t exist. To understand masks, we also need
to understand <code>BOOLEAN</code> objects in Python.</p>
<p>Boolean values include <code>True</code> or <code>False</code>. For
example,</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># set x to 5</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># what does the code below return?</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>x <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># how about this?</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>x <span class="op">==</span> <span class="dv">5</span></span></code></pre>
</div>
<p>When we ask Python what the value of <code>x &gt; 5</code> is, we get
<code>False</code>. This is because the condition,<code>x</code> is not
greater than 5, is not met since <code>x</code> is equal to 5.</p>
<p>To create a boolean mask:</p>
<ul>
<li>Set the True / False criteria
(e.g. <code>values &gt; 5 = True</code>)</li>
<li>Python will then assess each value in the object to determine
whether the value meets the criteria (True) or not (False).</li>
<li>Python creates an output object that is the same shape as the
original object, but with a <code>True</code> or <code>False</code>
value for each index location.</li>
</ul>
<p>Pandas provides multiple ways to to generate boolean sets of boolean
criteria to use for filtering. For example, we can select all rows where
subjects includes the work “Diversity” by using the <em>contains</em>
method in the <em>str</em> namespace.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>works_df.loc[works_df[<span class="st">"subjects"</span>].<span class="bu">str</span>.contains(<span class="st">"Diversity"</span>, na<span class="op">=</span><span class="va">False</span>)]</span></code></pre>
</div>
<p>Or we can select all rows with a checkouts greater than 0:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>works_df[works_df[<span class="st">"checkouts"</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre>
</div>
<p>We can define sets of criteria too using <em>&amp;</em> or
<em>|</em>. Parenthesis are required to help with order of
computation:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>works_df[(works_df.publication_date <span class="op">&gt;=</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (works_df.publication_date <span class="op">&lt;=</span> <span class="dv">2015</span>)]</span></code></pre>
</div>
<div class="section level3">
<h3 id="python-syntax-cheat-sheet">Python Syntax Cheat Sheet<a class="anchor" aria-label="anchor" href="#python-syntax-cheat-sheet"></a>
</h3>
<p>Use can use the syntax below when querying data by criteria from a
DataFrame. Experiment with selecting various subsets of the “works”
data.</p>
<ul>
<li>Equals: <code>==</code>
</li>
<li>Not equals: <code>!=</code>
</li>
<li>Greater than, less than: <code>&gt;</code> or <code>&lt;</code>
</li>
<li>Greater than or equal to <code>&gt;=</code>
</li>
<li>Less than or equal to <code>&lt;=</code>
</li>
</ul>
<div id="challenge---advanced-queries" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---advanced-queries" class="callout-inner">
<h3 class="callout-title">Challenge - Advanced Queries<a class="anchor" aria-label="anchor" href="#challenge---advanced-queries"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Select a subset of rows in the <code>works_df</code> DataFrame
that was published before 2010 and checked out less than five times. How
many rows did you end up with? What did your neighbor get?</p></li>
<li><p>You can use the <code>isin</code> command in Python to query a
DataFrame based upon a list of values as follows. Notice how the
indexing relies on a reference to the dataframe <em>being indexed</em>.
Think about the <em>order</em> in which the computer must evaluate these
statements.</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>works_df[</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>        works_df[<span class="st">'publication_date'</span>].isin([listGoesHere])</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>        ]</span></code></pre>
</div>
<p>Use the <code>isin</code> function to find all books published in
either 2010 or 2015. How many are there?</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Experiment with other queries. Create a query that finds all rows
with a checkouts greater than or equal to 1.</p></li>
<li><p>The <code>~</code> symbol in Python can be used to return the
OPPOSITE of the selection that you specify in Python. It is equivalent
to <strong>is not in</strong>. Write a query that selects all rows with
publication_date NOT equal to 2010 or 2015 in the works data.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>works_df[(works_df.publication_date <span class="op">&lt;</span> <span class="dv">2010</span>) <span class="op">&amp;</span> (works_df.checkouts <span class="op">&lt;</span> <span class="dv">5</span>)]</span></code></pre>
</div></li>
<li><div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>works_df[works_df[<span class="st">'publication_date'</span>].isin([<span class="dv">2010</span>,<span class="dv">2015</span>])]</span></code></pre>
</div></li>
<li>
</li>
</ol>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>works_df[works_df[<span class="st">'checkouts'</span>]<span class="op">&gt;=</span><span class="dv">1</span>]</span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>works_df[<span class="op">~</span>works_df[<span class="st">'publication_date'</span>].isin([<span class="dv">2010</span>,<span class="dv">2015</span>])]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="setting-values-using-slicing-by-criteria">Setting values using slicing by criteria<a class="anchor" aria-label="anchor" href="#setting-values-using-slicing-by-criteria"></a>
<a class="anchor" aria-label="anchor" href="#setting-values-using-slicing-by-criteria"></a>
</h2>
<hr class="half-width">
<p>Using slicing by criteria, we can directly set values. For example,
if we thought <em>Abusive men–Drama</em> was relevant to DEI, we could
set the <em>is_dei</em> flag on all records where subject contained that
string using the following syntax</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>works_df.loc[works_df.subjects.<span class="bu">str</span>.contains(<span class="st">'Abusive men--Drama'</span>), <span class="st">'is_dei'</span>] <span class="op">=</span> <span class="va">True</span></span></code></pre>
</div>
<div id="challenge---adjusting-the-dei-flag" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---adjusting-the-dei-flag" class="callout-inner">
<h3 class="callout-title">Challenge - Adjusting the DEI flag<a class="anchor" aria-label="anchor" href="#challenge---adjusting-the-dei-flag"></a>
</h3>
<div class="callout-content">
<p>Create a true copy of the works_df. Find a subject value you would
like to remove. If there is nothing you have issue with, just pick one
at random.</p>
<p>Use those critera to change the <em>is_dei</em> flag in your true
copy to <em>False</em>.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>For the example we will use “Aristocracy (Social class”</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>copy <span class="op">=</span> works_df.copy()</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="co"># we have to escape the '(' symbol</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>copy.loc[works_df.subjects.<span class="bu">str</span>.contains(<span class="st">'Aristocracy \(Social class'</span>), <span class="st">'is_dei'</span>] <span class="op">=</span> <span class="va">False</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-data-types-and-format"><p>Content from <a href="data-types-and-format.html">Data Types and Formats</a></p>
<hr>
<p>Last updated on 2024-05-16 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/data-types-and-format.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What types of data can be contained in a DataFrame?</li>
<li>Why is the data type important?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe how information is stored in a Python DataFrame.</li>
<li>Define the two main types of data in Python: text and numerics.</li>
<li>Examine the structure of a DataFrame.</li>
<li>Modify the format of values in a DataFrame.</li>
<li>Describe how data types impact operations.</li>
<li>Define, manipulate, and interconvert integers and floats in
Python.</li>
<li>Analyze datasets having missing/null values (NaN values).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>The format of individual columns and rows will impact analysis
performed on a dataset read into python. For example, you can’t perform
mathematical calculations on a string (text formatted data). This might
seem obvious, however sometimes numeric values are read into python as
strings. In this situation, when you then try to perform calculations on
the string-formatted numeric data, you get an error.</p>
<p>In this lesson we will review ways to explore and better understand
the structure and format of our data.</p>
<section><h2 class="section-heading" id="types-of-data">Types of Data<a class="anchor" aria-label="anchor" href="#types-of-data"></a>
<a class="anchor" aria-label="anchor" href="#types-of-data"></a>
</h2>
<hr class="half-width">
<p>How information is stored in a DataFrame or a python object affects
what we can do with it and the outputs of calculations as well. There
are two main types of data that we’re explore in this lesson: numeric
and text data types.</p>
<div class="section level3">
<h3 id="numeric-data-types">Numeric Data Types<a class="anchor" aria-label="anchor" href="#numeric-data-types"></a>
</h3>
<p>Numeric data types include integers and floats. A <strong>floating
point</strong> (known as a float) number has decimal points even if that
decimal point value is 0. For example: 1.13, 2.0 1234.345. If we have a
column that contains both integers and floating point numbers, Pandas
will assign the entire column to the float data type so the decimal
points are not lost.</p>
<p>An <strong>integer</strong> will never have a decimal point. Thus if
we wanted to store 1.13 as an integer it would be stored as 1.
Similarly, 1234.345 would be stored as 1234. You will often see the data
type <code>Int64</code> in python which stands for 64 bit integer. The
64 simply refers to the memory allocated to store data in each cell
which effectively relates to how many digits it can store in each
“cell”. Allocating space ahead of time allows computers to optimize
storage and processing efficiency.</p>
</div>
<div class="section level3">
<h3 id="text-data-type">Text Data Type<a class="anchor" aria-label="anchor" href="#text-data-type"></a>
</h3>
<p>Text data type is known as Strings in Python, or Objects in Pandas.
Strings can contain numbers and / or characters. For example, a string
might be a word, a sentence, or several sentences. A Pandas object might
also be a plot name like ‘plot1’. A string can also contain or consist
of numbers. For instance, ‘1234’ could be stored as a string. As could
‘10.23’. However <strong>strings that contain numbers can not be used
for mathematical operations</strong>!</p>
<p>Pandas and base Python use slightly different names for data types.
More on this is in the table below:</p>
<table class="table">
<colgroup>
<col width="9%">
<col width="17%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th>Pandas Type</th>
<th>Native Python Type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>The most general dtype. Will be assigned to your column if column
has mixed types (numbers and strings).</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>Numeric characters. 64 refers to the memory allocated to hold this
character.</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>Numeric characters with decimals. If a column contains numbers and
NaNs(see below), pandas will default to float64, in case your missing
value has a decimal.</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/A (but see the <a href="https://doc.python.org/2/library/datetime.html" class="external-link">datetime</a>
module in Python’s standard library)</td>
<td>Values meant to hold time data. Look into these for time series
experiments.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="checking-the-format-of-our-data">Checking the format of our data<a class="anchor" aria-label="anchor" href="#checking-the-format-of-our-data"></a>
</h3>
<p>Now that we’re armed with a basic understanding of numeric and text
data types, let’s explore the format of our survey data.</p>
<p>We alreayd learned that <code>DataFrame.dtypes</code> will return
info on all the columns, but we can also check the type of one column in
a DataFrame using the syntax
<code>dataFrameName[column_name].dtype</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>works_df[<span class="st">'subjects'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('O')</code></p>
<p>A type ‘O’ just stands for “object” which in Pandas’ world is a
string (text).</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>works_df[<span class="st">'publication_date'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('int64')</code></p>
<p>The type <code>int64</code> tells us that python is storing each
value within this column as a 64 bit integer. We can use the
<code>dat.dtypes</code> command to view the data type for each column in
a DataFrame (all at once).</p>
</div>
<div class="section level3">
<h3 id="working-with-integers-and-floats">Working With Integers and Floats<a class="anchor" aria-label="anchor" href="#working-with-integers-and-floats"></a>
</h3>
<p>Integers are the numbers we usually count with. Floats have
fractional parts (decimal places). Let’s next consider how the data type
can impact mathematical operations on our data. Addition, subtraction,
division and multiplication work on floats and integers as we’d
expect.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">24</span><span class="op">-</span><span class="dv">4</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="dv">20</span></span></code></pre>
</div>
<p>If we divide one integer by another, we get a float. The result on
python 3 is different than in python 2, where the result is an integer
(integer division).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">9</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fl">0.5555555555555556</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">10</span><span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fl">3.3333333333333335</span></span></code></pre>
</div>
<p>We can also convert a floating point number to an integer or an
integer to floating point number. Notice that Python by default rounds
down when it converts from floating point to integer.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># convert a to integer</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">7.83</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="bu">int</span>(a)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="dv">7</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># convert to float</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="bu">float</span>(b)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fl">7.0</span></span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="pandas-and-type-conversion">Pandas and type conversion<a class="anchor" aria-label="anchor" href="#pandas-and-type-conversion"></a>
<a class="anchor" aria-label="anchor" href="#pandas-and-type-conversion"></a>
</h2>
<hr class="half-width">
<p>Getting back to our data, we can modify the format of values within
it. Pandas interpreted the <code>mms_id</code> field as and integer, but
it is often more appropriate to treat id fields as strings, so let’s do
that now.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># convert the record_id field from an integer to a string</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>works_df[<span class="st">'mms_id'</span>] <span class="op">=</span> works_df[<span class="st">'mms_id'</span>].astype(<span class="st">'str'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>works_df[<span class="st">'mms_id'</span>].dtype</span></code></pre>
</div>
<p><strong>OUTPUT:</strong> <code>dtype('O')</code></p>
<p>While we only demonstrated this with <em>str</em> others like
<em>int</em>, <em>float</em>, etc., but not all conversions will succeed
and some may succeed but discard information, so you should always check
on the results of any conversions.</p>
</section><section><h2 class="section-heading" id="missing-data-values---nan">Missing Data Values - NaN<a class="anchor" aria-label="anchor" href="#missing-data-values---nan"></a>
<a class="anchor" aria-label="anchor" href="#missing-data-values---nan"></a>
</h2>
<hr class="half-width">
<p>Our <em>all_works.csv</em> file was carefully constructed to have no
missing values in the form of <code>null</code> or <code>NaN</code>, so
we will be importing a variant of that file that contains missing
values.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>null_df <span class="op">=</span> pd.read_csv(<span class="st">'null.csv'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>pd.isnull(null_df)</span></code></pre>
</div>
<p>A snippet of the output is below:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>	title	subjects	mms_id	author</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="dv">0</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="dv">1</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="dv">2</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="dv">3</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="dv">4</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	<span class="va">False</span>	</span></code></pre>
</div>
<p><em>NaN</em> (<strong>N</strong>ot <strong>a</strong>
<strong>N</strong>umber) values are undefined values that cannot be
represented mathematically. Pandas, for example, will read an empty cell
in a CSV or Excel sheet as a NaN. NaNs have some desirable properties:
if we were to average the checkouts column in our <em>null_df</em>
without replacing NaNs, Pandas would know to skip over those cells.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>null_df[<span class="st">'checkouts'</span>].mean()</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fl">0.5260636799098337</span></span></code></pre>
</div>
<p>Dealing with missing data values is always a challenge. It’s
sometimes hard to know why values are missing - was it because of a data
entry error? Or data that someone was unable to collect? Should the
value be 0? We need to know how missing values are represented in the
dataset in order to make good decisions. If we’re lucky, we have some
metadata that will tell us more about how null values were handled.</p>
<p>For instance, in some disciplines, like Remote Sensing, missing data
values are often defined as -9999. Having a bunch of -9999 values in
your data could really alter numeric calculations. Often in
spreadsheets, cells are left empty where no data are available. Pandas
will, by default, replace those missing values with NaN. However it is
good practice to get in the habit of intentionally marking cells that
have no data, with a no data value! That way there are no questions in
the future when you (or someone else) explores your data.</p>
<div class="section level3">
<h3 id="where-are-the-nans">Where Are the NaN’s?<a class="anchor" aria-label="anchor" href="#where-are-the-nans"></a>
</h3>
<div class="section level4">
<h4 id="finding-columns">Finding Columns<a class="anchor" aria-label="anchor" href="#finding-columns"></a>
</h4>
<p>Two options for finding what columns contain <em>NaN</em> values are
as follows:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># this method provides several columns of information including one that is a count of the not null values in</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># each colum</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>null_df.info()</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 14232 entries, 0 to 14231
Data columns (total 11 columns):
 #   Column             Non-Null Count  Dtype
---  ------             --------------  -----
 0   title              14196 non-null  object
 1   subjects           14196 non-null  object
 2   mms_id             14196 non-null  float64
 3   author             8505 non-null   object
 4   publication_date   14232 non-null  float64
 5   publication_place  14196 non-null  object
 6   language_code      14196 non-null  object
 7   resource_type      14196 non-null  object
 8   acquisition_date   14196 non-null  object
 9   is_dei             14196 non-null  object
 10  checkouts          14196 non-null  float64
dtypes: float64(3), object(8)
memory usage: 1.2+ MB</code></pre>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># this method takes advantage of the interpretation of true as 1 and false as 0</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># to return a series </span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>null_df.isnull().<span class="bu">sum</span>()</span></code></pre>
</div>
<p>which <strong>returns</strong>:</p>
<pre><code>title                  36
subjects               36
mms_id                 36
author               5727
publication_date        0
publication_place      36
language_code          36
resource_type          36
acquisition_date       36
is_dei                 36
checkouts              36
dtype: int64</code></pre>
</div>
<div class="section level4">
<h4 id="finding-the-actual-null-entries">Finding the actual null entries<a class="anchor" aria-label="anchor" href="#finding-the-actual-null-entries"></a>
</h4>
<p>We can use the <code>isnull</code> method to do this. The
<code>isnull</code> method will compare each cell with a null value. If
an element has a null value, it will be assigned a value of
<code>True</code> in the output object.</p>
<p>To select the rows where there are null values, we can use the mask
as an index to subset our data as follows:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># To select just the rows with NaN values, we can use the 'any()' method</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>null_df[pd.isnull(null_df).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre>
</div>
<p>We can run <code>isnull</code> on a particular column too. What does
the code below do?</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># what does this do?</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>empty_authors <span class="op">=</span> null_df[null_df[<span class="st">'author'</span>].isnull()]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="bu">print</span>(empty_authors)</span></code></pre>
</div>
<p>Let’s take a minute to look at the statement above. We are using the
Boolean object <code>null_df['author'].isnull()</code> to filter
<code>null_df</code>. We are asking Python to select rows that have a
<code>NaN</code> value of author. While we obtained the booleans using a
method of the author column, we could have done it using
<code>pd.isnull(null_df['author'])</code> instead if we preferred.</p>
</div>
<div class="section level4">
<h4 id="dealing-with-the-nans">Dealing with the NaN’s?<a class="anchor" aria-label="anchor" href="#dealing-with-the-nans"></a>
</h4>
<p>Assuming we determine that missing checkouts indeed should be zero,
we can replace all <em>NaN</em> values with zeroes using the
<code>.fillna()</code> method:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># fill all NaN values with 0</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>null_df[<span class="st">'checkouts'</span>] <span class="op">=</span> null_df[<span class="st">'checkouts'</span>].fillna(<span class="dv">0</span>)</span></code></pre>
</div>
<p>However NaN and 0 yield different analysis results. The mean value
when NaN values are replaced with 0 is different from when NaN values
are simply thrown out or ignored.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>null_df[<span class="st">'checkouts'</span>].mean()</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fl">0.5247329960652052</span></span></code></pre>
</div>
<p>We can fill NaN values with any value that we chose. While a bit
silly, the code below fills all NaN values in the publication_date
column with the mean for mean for all publication_dates. This is
possible because our publications_date is just the 4 digit year with
dtype of integer.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a> null_df[<span class="st">'publication_date'</span>] <span class="op">=</span> null_df[<span class="st">'publication_date'</span>].fillna(null_df[<span class="st">'publication_date'</span>].mean())</span></code></pre>
</div>
<p>We could also choose to create a subset of our data, only keeping
rows that do not contain NaN values.</p>
<p>The point is to make conscious decisions about how to manage missing
data. This is where we think about how our data will be used and how
these values will impact the scientific conclusions made from the
data.</p>
<p>Python gives us all of the tools that we need to account for these
issues. We just need to be cautious about how the decisions that we make
impact the validity of any conclusions drawn from it.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="recap">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
<a class="anchor" aria-label="anchor" href="#recap"></a>
</h2>
<hr class="half-width">
<p>What we’ve learned:</p>
<ul>
<li>How to explore the data types of columns within a DataFrame</li>
<li>How to change the data type</li>
<li>What NaN values are, how they might be represented, and what this
means for your work</li>
<li>How to replace NaN values, if desired</li>
</ul></section></section><section id="aio-merging-data"><p>Content from <a href="merging-data.html">Combining DataFrames with pandas</a></p>
<hr>
<p>Last updated on 2024-08-05 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/merging-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I work with data from multiple sources?</li>
<li>How can I combine data from different data sets?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Combine data from multiple files into a single DataFrame using merge
and concat.</li>
<li>Combine two DataFrames using a unique ID found in both
DataFrames.</li>
<li>Employ <code>to_csv</code> to export a DataFrame in CSV format.</li>
<li>Join DataFrames using common fields (join keys).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>In many “real world” situations, the data that we want to use come in
multiple files. We often need to combine these files into a single
DataFrame to analyze the data. The pandas package provides <a href="https://pandas.pydata.org/pandas-docs/stable/merging.html" class="external-link">various
methods for combining DataFrames</a> including <code>merge</code> and
<code>concat</code>.</p>
<p>In order to get more practice with slicing and subsetting, we will
opt to create subsets of the works_df instead of loading in data from
multiple files.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>top_concat_df <span class="op">=</span> works_df.head()</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>bottom_concat_df <span class="op">=</span> works_df.tail().reset_index()</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>left_concat_df <span class="op">=</span> works_df.iloc[:,<span class="dv">0</span>:<span class="dv">3</span>]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>right_concat_df <span class="op">=</span> works_df.iloc[:,<span class="dv">3</span>:]</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>left_merge_df <span class="op">=</span> works_df[[<span class="st">'mms_id'</span>,<span class="st">'title'</span>]]</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>left_merge_df <span class="op">=</span> left_merge_df.drop_duplicates()</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>right_merge_df <span class="op">=</span> works_df[[<span class="st">'mms_id'</span>,<span class="st">'author'</span>]].sample(frac<span class="op">=</span><span class="fl">.8</span>,random_state<span class="op">=</span><span class="dv">42</span>).drop_duplicates()</span></code></pre>
</div>
<section><h2 class="section-heading" id="concatenating-dataframes">Concatenating DataFrames<a class="anchor" aria-label="anchor" href="#concatenating-dataframes"></a>
<a class="anchor" aria-label="anchor" href="#concatenating-dataframes"></a>
</h2>
<hr class="half-width">
<p>We can use the <code>concat</code> function in Pandas to append
either columns or rows from one DataFrame to another. When we
concatenate DataFrames, we need to specify the axis. <code>axis=0</code>
tells Pandas to stack the second DataFrame under the first one. It will
automatically detect whether the column names are the same and will
stack accordingly. <code>axis=1</code> will stack the columns in the
second DataFrame to the RIGHT of the first DataFrame. To stack the data
vertically, we need to make sure we have the same columns and associated
column format in both datasets. When we stack horizonally, we want to
make sure what we are doing makes sense (ie the data are related in some
way).</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># stack the DataFrames on top of each other</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>vertical_stack <span class="op">=</span> pd.concat([top_concat_df, bottom_concat_df], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># place the DataFrames side by side</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>horizontal_stack <span class="op">=</span> pd.concat([left_concat_df, right_concat_df], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<div class="section level4">
<h4 id="row-index-values-and-concat">Row Index Values and Concat<a class="anchor" aria-label="anchor" href="#row-index-values-and-concat"></a>
</h4>
<p>Have a look at the <code>vertical_stack</code> dataframe? Notice
anything unusual? The row indexes for the two data frames
<code>top_concat_df</code> and <code>bottom_concat_df</code> have been
repeated. We can reindex the new dataframe using the
<code>reset_index()</code> method.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># reset index and drop previous index values rather than convert to data column</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>vertical_stack.reset_index(drop<span class="op">=</span><span class="va">True</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="writing-out-data-to-csv">Writing Out Data to CSV<a class="anchor" aria-label="anchor" href="#writing-out-data-to-csv"></a>
</h3>
<p>We can use the <code>to_csv</code> command to do export a DataFrame
in CSV format. Note that the code below will by default save the data
into the current working directory. We can save it to a different folder
by adding the foldername and a slash to the file
<code>vertical_stack.to_csv('foldername/out.csv')</code>. We use the
‘index=False’ so that pandas doesn’t include the index number for each
line.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Write DataFrame to CSV</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>vertical_stack.to_csv(<span class="st">'out.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>Check out your working directory to make sure the CSV wrote out
properly, and that you can open it! If you want, try to bring it back
into python to make sure it imports properly.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># read our output back into python and make sure all looks good</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>new_output <span class="op">=</span> pd.read_csv(<span class="st">'out.csv'</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>new_output</span></code></pre>
</div>
<div id="challenge---combine-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---combine-data" class="callout-inner">
<h3 class="callout-title">Challenge - Combine Data<a class="anchor" aria-label="anchor" href="#challenge---combine-data"></a>
</h3>
<div class="callout-content">
<p>Make your own subsets and combine them however you like. Output at
least once and read it back in. Did you get what you expected?</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="joining-dataframes">Joining DataFrames<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
</h2>
<hr class="half-width">
<p>When we concatenated our DataFrames we simply added them to each
other - stacking them either vertically or side by side. Another way to
combine DataFrames is to use columns in each dataset that contain common
values (a common unique id). Combining DataFrames using a common field
is called “joining”. The columns containing the common values are called
“join key(s)”. Joining DataFrames in this way is often useful when one
DataFrame is a “lookup table” containing additional data that we want to
include in the other.</p>
<p>NOTE: This process of joining tables is similar to what we do with
tables in an SQL database.</p>
<div class="section level3">
<h3 id="identifying-join-keys">Identifying join keys<a class="anchor" aria-label="anchor" href="#identifying-join-keys"></a>
</h3>
<p>To identify appropriate join keys we first need to know which
field(s) are shared between the files (DataFrames). We might inspect
both DataFrames to identify these columns. If we are lucky, both
DataFrames will have columns with the same name that also contain the
same data. If we are less lucky, we need to identify a
(differently-named) column in each DataFrame that contains the same
information.</p>
<p>In our example, the join key is the column containing the identifier,
which is called <code>mms_id</code>.</p>
<p>Now that we have a common key, we are almost ready to join our data.
However, since there are <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" class="external-link">different
types of joins</a>, we also need to decide which type of join makes
sense for our analysis.</p>
</div>
<div class="section level3">
<h3 id="inner-joins">Inner joins<a class="anchor" aria-label="anchor" href="#inner-joins"></a>
</h3>
<p>The most common type of join is called an <em>inner join</em>. An
inner join combines two DataFrames based on a join key and returns a new
DataFrame that contains <strong>only</strong> those rows that have
matching values in <em>both</em> of the original DataFrames.</p>
<p>Inner joins yield a DataFrame that contains only rows where the value
being joins exists in BOTH tables.</p>
<p>The pandas function for performing joins is called <code>merge</code>
and an Inner join is the default option:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>merged_inner <span class="op">=</span> pd.merge(left<span class="op">=</span>left_merge_df,right<span class="op">=</span>right_merge_df, on<span class="op">=</span><span class="st">'mms_id'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># what's the size of the output data?</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="bu">print</span>(merged_inner.shape)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>merged_inner</span></code></pre>
</div>
<p><strong>OUTPUT:</strong></p>
<pre><code>(12848, 3)
mms_id	title	author
0	991004617919702908	"A god of justice?" : the problem of evil in t...	Whitted, Qiana J., 1974-
1	991004617919702908	"A god of justice?" : the problem of evil in t...	Whitted, Qiana J., 1974-
2	991003607949702908	"Baad bitches" and sassy supermamas : Black po...	Dunn, Stephane, 1967-
3	991003607949702908	"Baad bitches" and sassy supermamas : Black po...	Dunn, Stephane, 1967-
4	991013190057102908	"Codependent lesbian space alien seeks same"	Olnek, Madeleine.; Space Aliens, LLC.</code></pre>
<p>The result of an inner join of <code>left_merge_df</code> and
<code>right_merge_df</code> is a new DataFrame that contains the
combined set of columns from those tables. It <em>only</em> contains
rows that have <em>mms_id</em> codes that are the same in both
DataFrames.</p>
<p>The two DataFrames that we want to join were passed to the
<code>merge</code> function using <code>on</code> since the key colums
in boht dataframes was the same. If they had been different, we could
still do it but we would have to use <code>left_on</code> and
<code>right_on</code> arguments with the appropriate column names
instead of just one.</p>
<p>Notice that <code>merged_inner</code> has fewer rows than
<code>left_merge_df</code>. This is an indication that there were rows
in <code>left_merge_df</code> with value(s) for <code>mms_id</code> that
do not exist as value(s) for <code>mms_id</code> in
<code>right_merge_df</code>.</p>
</div>
<div class="section level3">
<h3 id="left-joins">Left joins<a class="anchor" aria-label="anchor" href="#left-joins"></a>
</h3>
<p>What if we wanted to merge these two without losing any of the
information from <code>left_merge_df</code>? In this case, we use a
different type of join called a “left outer join”, or a “left join”.</p>
<p>Like an inner join, a left join uses join keys to combine two
DataFrames. Unlike an inner join, a left join will return <em>all</em>
of the rows from the <code>left</code> DataFrame, even those rows whose
join key(s) do not have values in the <code>right</code> DataFrame. Rows
in the <code>left</code> DataFrame that are missing values for the join
key(s) in the <code>right</code> DataFrame will simply have null (i.e.,
NaN or None) values for those columns in the resulting joined
DataFrame.</p>
<p>Note: a left join will still discard rows from the <code>right</code>
DataFrame that do not have values for the join key(s) in the
<code>left</code> DataFrame.</p>
<p>A left join is performed in pandas by calling the same
<code>merge</code> function used for inner join, but using the
<code>how='left'</code> argument:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>merged_left <span class="op">=</span> pd.merge(left<span class="op">=</span>left_merge_df,right<span class="op">=</span>right_merge_df, on<span class="op">=</span><span class="st">'mms_id'</span>,how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># what's the size of the output data?</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape:"</span>, merged_left.shape)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Missing Authors:"</span>, merged_left.author.isnull().<span class="bu">sum</span>())</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>merged_left</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="op">**</span>OUTPUT:<span class="op">**</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>shape: (<span class="dv">14232</span>, <span class="dv">3</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>Missing Authors: <span class="dv">1384</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>mms_id	title	author</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="dv">0</span>	<span class="dv">991004617919702908</span>	<span class="st">"A god of justice?"</span> : the problem of evil <span class="kw">in</span> t...	Whitted, Qiana J., <span class="dv">1974</span><span class="op">-</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="dv">1</span>	<span class="dv">991003607949702908</span>	<span class="st">"Baad bitches"</span> <span class="kw">and</span> sassy supermamas : Black po...	Dunn, Stephane, <span class="dv">1967</span><span class="op">-</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="dv">2</span>	<span class="dv">991013190057102908</span>	<span class="st">"Codependent lesbian space alien seeks same"</span>	Olnek, Madeleine.<span class="op">;</span> Space Aliens, LLC.</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="dv">3</span>	<span class="dv">991003662979702908</span>	<span class="st">"Lactilla tends her fav'rite cow"</span> : ecocritica...	Milne, Anne.</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="dv">4</span>	<span class="dv">991008089169702908</span>	<span class="st">"The useless mouths"</span>, <span class="kw">and</span> other literary writings	Beauvoir, Simone de, <span class="dv">1908</span><span class="op">-</span><span class="fl">1986.</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>...	...	...	...</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="dv">14227</span>	<span class="dv">991013597402302908</span>	¡Ban c<span class="op">/</span>s this<span class="op">!</span> : the BSP anthology of Xican<span class="op">@</span> l...	Rivera, Santino J., editor.</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="dv">14228</span>	<span class="dv">991010673989702908</span>	¡Muy pop<span class="op">!</span> : conversations on Latino popular cu...	Stavans, Ilan.</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="dv">14229</span>	<span class="dv">991004452179702908</span>	¡Viva la historieta<span class="op">!</span> : Mexican comics, NAFTA, ...	Campbell, Bruce, <span class="dv">1964</span><span class="op">-</span> author.</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="dv">14230</span>	<span class="dv">991013093859602908</span>	Đời về cơ bản là buồn cười	Lê, Bích, author.</span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="dv">14231</span>	<span class="dv">991013054957702908</span>	Đường vào văn chương : phê bình lý trí ...	Đặng, Phùng Quân, <span class="dv">1942</span><span class="op">-</span> author.</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="dv">14232</span> rows × <span class="dv">3</span> columns</span></code></pre>
</div>
<p>The result DataFrame from a left join (<code>merged_left</code>)
looks very much like the result DataFrame from an inner join
(<code>merged_inner</code>) in terms of the columns it contains.
However, unlike <code>merged_inner</code>, <code>merged_left</code>
contains the <strong>same number of rows</strong> as the original
<code>left_merge_df</code> DataFrame. When we inspect
<code>merged_left</code>, we find there are rows where the information
that should have come from <code>right_merge_df</code> (i.e.,
<code>author</code>) is missing (they contain NaN values):</p>
</div>
<div class="section level3">
<h3 id="other-join-types">Other join types<a class="anchor" aria-label="anchor" href="#other-join-types"></a>
</h3>
<p>The pandas <code>merge</code> function supports two other join
types:</p>
<ul>
<li>Right (outer) join: Invoked by passing <code>how='right'</code> as
an argument. Similar to a left join, except <em>all</em> rows from the
<code>right</code> DataFrame are kept, while rows from the
<code>left</code> DataFrame without matching join key(s) values are
discarded.</li>
<li>Full (outer) join: Invoked by passing <code>how='outer'</code> as an
argument. This join type returns the all pairwise combinations of rows
from both DataFrames; i.e., the result DataFrame will <code>NaN</code>
where data is missing in one of the dataframes. This join type is very
rarely used.</li>
</ul>
</div>
<div class="section level3">
<h3 id="making-composite-keys">Making Composite Keys<a class="anchor" aria-label="anchor" href="#making-composite-keys"></a>
</h3>
<p>Sometimes a data file might not have an obvious key in a single
column, but we may be able to generate a suitable key by combining two
or more columns into what is known as a <em>composite</em> key.</p>
<p>Let’s see an example of this by importing the <em>ethnicity.csv</em>
and <em>gender.csv</em>, and then examining one of them.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ethicity_df <span class="op">=</span> pd.read_csv(<span class="st">'ethnicity.csv'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>gender_df <span class="op">=</span> pd.read_csv(<span class="st">'gender.csv'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="bu">print</span>(gender_df.head())</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="bu">print</span>(ethicity_df.head())</span></code></pre>
</div>
<p>They both have <em>term</em> and <em>year</em> columns that contain
duplication. However, we could combine these colums into a composite key
that would be unique for each dataframe. We will also strip away any
potential leading or trailing whitespace as a precaution.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>gender_df[<span class="st">"key"</span>] <span class="op">=</span> gender_df.year.astype(<span class="bu">str</span>).<span class="bu">str</span>.strip() <span class="op">+</span> gender_df.term.<span class="bu">str</span>.strip()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>ethnicity_df[<span class="st">"key"</span>] <span class="op">=</span> ethnicity_df.year.astype(<span class="bu">str</span>).<span class="bu">str</span>.strip() <span class="op">+</span> ethnicity_df.term.<span class="bu">str</span>.strip()</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>gender_df</span></code></pre>
</div>
<p>Now that we have a shared key, we will drop the <em>term</em> and
<em>year</em> columns from one of the dataframes as we merge. Otherwise,
we would end up with duplicate columns that are automatically renamed
with a prefix to prevent naming collision. Simply dropping won’t always
be the best approach, but is safe to do so in our case using a inner
join.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>gender_ethnicity_df <span class="op">=</span> pd.merge(gender_df.drop(columns<span class="op">=</span>[<span class="st">"term"</span>,<span class="st">"year"</span>]), ethnicity_df, on<span class="op">=</span><span class="st">'key'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="bu">print</span>(gender_ethnicity_df.shape)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>gender_ethnicity_df</span></code></pre>
</div>
<div id="challenge---joins" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---joins" class="callout-inner">
<h3 class="callout-title">Challenge - Joins<a class="anchor" aria-label="anchor" href="#challenge---joins"></a>
</h3>
<div class="callout-content">
<p>Create a new DataFrame by joining the contents of the
<code>gender.csv</code> and <code>ethnicity.csv</code> tables. Make it a
left join where gender is the left dataframe.</p>
<p>Calculate the:</p>
<ol style="list-style-type: decimal">
<li>Number of ethnicity records that were dropped</li>
<li>Number of rows where ethnicity data is NaN</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Solution to challenge
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                  left<span class="op">=</span>pd.read_csv(<span class="st">"gender.csv"</span>),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                  right<span class="op">=</span>pd.read_csv(<span class="st">"ethnicity.csv"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                  on<span class="op">=</span><span class="st">"['year','term']"</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                  )</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># Part 1: Number of ethnicity records that were dropped</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>ethnicity_df.shape[<span class="dv">0</span>] <span class="op">-</span> merged.shape[<span class="dv">0</span>]</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># Part 2: Number of rows where ethnicity data is NaN</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>merged.isnull().<span class="bu">sum</span>() <span class="co"># this will find all columns with null values and effectively count them</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co"># you can *or* the columns with *nulls* to filter the dataframe and take the first value of shape</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>merged[merged.intl.isnull()<span class="op">|</span> merged.pacific_islander.isnull()].shape[<span class="dv">0</span>]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-loops-and-functions"><p>Content from <a href="loops-and-functions.html">Data workflows and automation</a></p>
<hr>
<p>Last updated on 2024-08-05 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/loops-and-functions.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 90 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I automate operations in Python?</li>
<li>What are functions and why should I use them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe why for loops are used in Python.</li>
<li>Employ for loops to automate data analysis.</li>
<li>Write unique filenames in Python.</li>
<li>Build reusable code in Python.</li>
<li>Write functions using conditional statements (if, then, else).</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>So far, we’ve used Python and the pandas library to explore and
manipulate individual datasets by hand, much like we would do in a
spreadsheet. The beauty of using a programming language like Python,
though, comes from the ability to automate data processing through the
use of loops and functions.</p>
<section><h2 class="section-heading" id="for-loops">For loops<a class="anchor" aria-label="anchor" href="#for-loops"></a>
<a class="anchor" aria-label="anchor" href="#for-loops"></a>
</h2>
<hr class="half-width">
<p>Loops allow us to repeat a workflow (or series of actions) a given
number of times or while some condition is true. We would use a loop to
automatically process data that’s stored in multiple files (daily values
with one file per year, for example). Loops lighten our work load by
performing repeated tasks without our direct involvement and make it
less likely that we’ll introduce errors by making mistakes while
processing each file by hand.</p>
<p>Let’s write a simple for loop:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> animals <span class="op">=</span> [<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'bear'</span>]</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(animals)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>[<span class="st">'lion'</span>, <span class="st">'tiger'</span>, <span class="st">'bear'</span>]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> creature <span class="kw">in</span> animals:</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>...    <span class="bu">print</span>(creature)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>lion</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>tiger</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>bear</span></code></pre>
</div>
<p>The line defining the loop must start with <code>for</code> and end
with a colon, and the body of the loop must be indented.</p>
<p>In this example, <code>creature</code> is the loop variable that
takes the value of the next entry in <code>animals</code> every time the
loop goes around. We can call the loop variable anything we like. After
the loop finishes, the loop variable will still exist and will have the
value of the last entry in the collection.</p>
<p>It is often handy to have the index for each item in the collection
as well. We can get a tuple with both by using
<code>enumerate</code></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="cf">for</span> creature <span class="kw">in</span> <span class="bu">enumerate</span>(animals):</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>...    <span class="bu">print</span>(creature[<span class="dv">0</span>],creature[<span class="dv">1</span>])</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="dv">0</span> lion</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="dv">1</span> tiger</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="dv">2</span> bear</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="automating-data-processing-using-for-loops">Automating data processing using For Loops<a class="anchor" aria-label="anchor" href="#automating-data-processing-using-for-loops"></a>
<a class="anchor" aria-label="anchor" href="#automating-data-processing-using-for-loops"></a>
</h2>
<hr class="half-width">
<p>Suppose that we were working with a much larger set of books. It
might be useful to split them out into smaller groups, e.g., by date of
publication.</p>
<p>Let’s start by making a new directory inside our current working
folder. Python has a built-in library called <code>os</code> for this
sort of operating-system dependent behaviour.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>os.mkdir(<span class="st">'yearly_files'</span>)</span></code></pre>
</div>
<p>We can check that the folder was created by listing the contents of
the current directory:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>os.listdir()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>[<span class="st">'gender.csv'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a> <span class="st">'.DS_Store'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a> <span class="st">'ethnicity.csv'</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a> <span class="st">'Untitled.ipynb'</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a> <span class="st">'yearly_files'</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a> <span class="st">'out.csv'</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a> <span class="st">'all_works.csv'</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a> <span class="st">'.virtual_documents'</span>,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a> <span class="st">'.ipynb_checkpoints'</span>]</span></code></pre>
</div>
<p>In previous lessons, we saw how to use the library pandas to load
data into memory as a DataFrame, how to select a subset of the data
using some criteria, and how to write the DataFrame into a csv file.
Let’s write a script that performs those three steps in sequence to
write out records for the year <em>1948</em> from <em>all_works.csv</em>
as a seperate csv in the <code>yearly_files</code> directory</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># Load the data into a DataFrame</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>all_works_df <span class="op">=</span> pd.read_csv(<span class="st">'all_works.csv'</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># Select only data for 1948</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>df_1948 <span class="op">=</span> all_works_df[all_works_df.publication_date <span class="op">==</span> <span class="dv">1948</span>]</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>df_1948.to_csv(<span class="st">'yearly_files/1948Publications.csv'</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co"># Then check that that file now exists:</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>os.listdir(<span class="st">"yearly_files"</span>)</span></code></pre>
</div>
<p>To create yearly data files, we could repeat the last two commands
over and over, once for each year of data. Repeating code is neither
elegant nor practical, and is very likely to introduce errors into your
code. We want to turn what we’ve just written into a loop that repeats
the last two commands for every year in the dataset.</p>
<p>Let’s start by writing a loop that simply prints the names of the
files we want to create - the dataset we are using covers 31 years
bewteen 1948 and 2024, and we’ll create a separate file for each of
those years. Listing the filenames is a good way to confirm that the
loop is behaving as we expect.</p>
<p>We have seen that we can loop over a list of items, so we need a list
of years to loop over. We can get the unique years in our DataFrame
with:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>all_works_df[<span class="st">'publication_year'</span>].unique()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>array([<span class="dv">2009</span>, <span class="dv">2008</span>, <span class="dv">2011</span>, <span class="dv">2018</span>, <span class="dv">2021</span>, <span class="dv">2014</span>, <span class="dv">2010</span>, <span class="dv">2019</span>, <span class="dv">2020</span>, <span class="dv">2017</span>, <span class="dv">2022</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>       <span class="dv">2013</span>, <span class="dv">2012</span>, <span class="dv">2015</span>, <span class="dv">2007</span>, <span class="dv">2016</span>, <span class="dv">2023</span>, <span class="dv">2006</span>, <span class="dv">2003</span>, <span class="dv">2001</span>, <span class="dv">2005</span>, <span class="dv">1948</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>       <span class="dv">1994</span>, <span class="dv">1998</span>, <span class="dv">1990</span>, <span class="dv">1999</span>, <span class="dv">1992</span>, <span class="dv">1973</span>, <span class="dv">1949</span>, <span class="dv">2024</span>, <span class="dv">1981</span>])</span></code></pre>
</div>
<p>We can start builing our for loop as follows, and test out our naming
convention is working before writing any actual files to disk.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(all_works_df[<span class="st">'publication_date'</span>].unique()):</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'yearly_files/</span><span class="sc">{}</span><span class="st">Publications.csv'</span>.<span class="bu">format</span>(year)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="bu">print</span>(filename)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1948</span><span class="er">Publications</span>.csv</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1949</span><span class="er">Publications</span>.csv</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1973</span><span class="er">Publications</span>.csv</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1981</span><span class="er">Publications</span>.csv</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1990</span><span class="er">Publications</span>.csv</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>yearly_files<span class="op">/</span><span class="dv">1992</span><span class="er">Publications</span>.csv</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>etc.</span></code></pre>
</div>
<p>We can now add the rest of the steps we need to create separate text
files:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(all_works_df[<span class="st">'publication_date'</span>].unique()):</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'yearly_files/</span><span class="sc">{}</span><span class="st">Publications.csv'</span>.<span class="bu">format</span>(year)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    publish_year <span class="op">=</span> all_works_df[all_works_df.publication_date <span class="op">==</span> year]</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    publish_year.to_csv(filename)</span></code></pre>
</div>
<p>Look inside the <code>yearly_files</code> directory and check a
couple of the files you just created to confirm that everything worked
as expected.</p>
</section><section><h2 class="section-heading" id="writing-unique-filenames">Writing Unique Filenames<a class="anchor" aria-label="anchor" href="#writing-unique-filenames"></a>
<a class="anchor" aria-label="anchor" href="#writing-unique-filenames"></a>
</h2>
<hr class="half-width">
<p>Notice that the code above created a unique filename for each
year.</p>
<pre><code>filename = 'yearly_files/{}Publications.csv'.format(year)</code></pre>
<p>Let’s break down the parts of this name:</p>
<ul>
<li>The first part is simply some text that specifies the directory to
store our data file in <code>yearly_files/</code>
</li>
<li>We want to dynamically insert the value of the year into the
filename. We can do this by indicating a placeholder location inside the
string with <code>{}</code>, and then specifying the value that will go
there with <code>.format(value)</code>
</li>
<li>Finally, we specify a fixed portion of the filename and the file
type with <code>Publications.csv</code>. Since the <code>.</code> is
inside the string, it doesn’t behave the same way as dot notation in
Python commands.</li>
</ul>
<p>Notice the difference between the filename - wrapped in quote marks -
and the variable (<code>year</code>), which is not wrapped in quote
marks. The result looks like
<code>'yearly_files/1948Publications.csv'</code> which contains the path
to the new filename AND the file name itself.</p>
<div id="challenge---building-loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---building-loops" class="callout-inner">
<h3 class="callout-title">Challenge - Building loops<a class="anchor" aria-label="anchor" href="#challenge---building-loops"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Build a loop that reads in each publications csv file into a
dataframe, counts how many records are in the df, and then prints that
number out to the screen along with the filename. Recommend using the
glob library to simplfy this task, but if you are creative you can do it
with os library instead.</p></li>
<li><p>Compare your results to the output of
<code>all_works_df['publication_date'].value_counts().sort_index()</code></p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="im">import</span> glob</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>files <span class="op">=</span> <span class="bu">sorted</span>(glob.glob(<span class="st">'yearly_files/*Publication*.csv'</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="cf">for</span> f <span class="kw">in</span> files:</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    df <span class="op">=</span> pd.read_csv(f)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>    <span class="bu">print</span>(f[<span class="dv">13</span>:<span class="dv">17</span>],df.shape[<span class="dv">0</span>])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="building-reusable-and-modular-code-with-functions">Building reusable and modular code with functions<a class="anchor" aria-label="anchor" href="#building-reusable-and-modular-code-with-functions"></a>
<a class="anchor" aria-label="anchor" href="#building-reusable-and-modular-code-with-functions"></a>
</h2>
<hr class="half-width">
<p>Suppose that separating large data files into individual yearly files
is a task that we frequently have to perform. We could write a
<strong>for loop</strong> like the one above every time we needed to do
it but that would be time consuming and error prone. A more elegant
solution would be to create a reusable tool that performs this task with
minimum input from the user. To do this, we are going to turn the code
we’ve already written into a function.</p>
<p>Functions are reusable, self-contained pieces of code that are called
with a single command. They can be designed to accept arguments as input
and return values, but they don’t need to do either. Variables declared
inside functions only exist while the function is running and if a
variable within the function (a local variable) has the same name as a
variable somewhere else in the code, the local variable hides but
doesn’t overwrite the other.</p>
<p>Every method used in Python (for example, <code>print</code>) is a
function, and the libraries we import (say, <code>pandas</code>) are a
collection of functions. We will only use functions that are housed
within the same code that uses them, but it’s also easy to write
functions that can be used by different programs.</p>
<p>Functions are declared following this general structure:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="kw">def</span> this_is_the_function_name(input_argument1, input_argument2):</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="co"># The body of the function is indented</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="co">"""This is the docstring of the function. Wrapped in triple-quotes,</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">    it can span across multiple lines. This is what is shown if you ask</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">    for help about the function like this: help(this_is_the_function_name)</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    </span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="co"># This function prints the two arguments to screen</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'The function arguments are:'</span>, input_argument1, input_argument2, <span class="st">'(this is done inside the function!)'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="co"># And returns their product</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>    <span class="cf">return</span> input_argument1 <span class="op">*</span> input_argument2</span></code></pre>
</div>
<p>The function declaration starts with the word <code>def</code>,
followed by the function name and any arguments in parenthesis, and ends
in a colon. The body of the function is indented just like loops are. If
the function returns something when it is called, it includes a return
statement at the end.</p>
<p>This is how we call the function:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>product_of_inputs <span class="op">=</span> this_is_the_function_name(<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>The function arguments are: <span class="dv">2</span> <span class="dv">5</span> (this <span class="kw">is</span> done inside the function<span class="op">!</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Their product is:'</span>, product_of_inputs, <span class="st">'(this is done outside the function!)'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>Their product <span class="kw">is</span>: <span class="dv">10</span> (this <span class="kw">is</span> done outside the function<span class="op">!</span>)</span></code></pre>
</div>
<div id="challenge---functions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---functions" class="callout-inner">
<h3 class="callout-title">Challenge - Functions<a class="anchor" aria-label="anchor" href="#challenge---functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Change the values of the arguments in the function and check its
output</li>
<li>Try calling the function by giving it the wrong number of arguments
(not 2) or not assigning the function call to a variable (no
<code>var_name =</code>)</li>
<li>Declare a variable inside the function and test to see where it
exists (Hint: can you print it from outside the function?)</li>
<li>Explore what happens when a variable both inside and outside the
function have the same name. What happens to the global variable when
you change the value of the local variable?</li>
</ol>
</div>
</div>
</div>
<p>We can now turn our code for saving yearly data files into a
function. There are many different “chunks” of this code that we can
turn into functions, and we can even create functions that call other
functions inside them. Let’s first write a function that separates data
for just one year and saves that data to a file:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data):</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">    this_year: int</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>    texts_year <span class="op">=</span> all_data[all_data.publication_date <span class="op">==</span> this_year]</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>    filename <span class="op">=</span> <span class="st">'yearly_files/function_works'</span> <span class="op">+</span> <span class="bu">str</span>(this_year) <span class="op">+</span> <span class="st">'.csv'</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>    texts_year.to_csv(filename)</span></code></pre>
</div>
<p>The text between the two sets of triple quotes is called a docstring
and contains the documentation for the function. It does nothing when
the function is running and is therefore not necessary, but it is good
practice to include docstrings as a reminder of what the code does.
Docstrings in functions also become part of their ‘official’
documentation:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>one_year_csv_writer?</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>one_year_csv_writer(<span class="dv">2023</span>,all_works_df)</span></code></pre>
</div>
<p>We changed the root of the name of the csv file so we can distinguish
it from the one we wrote before. Check the <code>yearly_files</code>
directory for the file. Did it do what you expect?</p>
<p>What we really want to do, though, is create files for multiple years
without having to request them one by one. Let’s write another function
that replaces the entire <em>for</em> loop by simply looping through a
sequence of years and repeatedly calling the function we just wrote,
<code>one_year_csv_writer</code>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data):</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">    Writes separate csv files for each year of data.</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">    start_year: int</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">        the first year of data we want</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">    end_year: int</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>    years <span class="op">=</span> all_data.publication_date.unique()</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>      <span class="cf">if</span> year <span class="kw">in</span> years:</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>        one_year_csv_writer(year, all_data)</span></code></pre>
</div>
<p>Because people will naturally expect that the end year for the files
is the last year with data, the for loop inside the function ends at
<code>end_year + 1</code>. By writing the entire loop into a function,
we’ve made a reusable tool for whenever we need to break a large data
file into yearly files. Because we can specify the first and last year
for which we want files, we can even use this function to create files
for a subset of the years available. This is how we call this
function:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Create csv files</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>yearly_data_csv_writer(<span class="dv">2008</span>, <span class="dv">2023</span>, all_works_df)</span></code></pre>
</div>
<p>BEWARE! If you are using IPython Notebooks and you modify a function,
you MUST re-run that cell in order for the changed function to be
available to the rest of the code. Nothing will visibly happen when you
do this, though, because simply defining a function without
<em>calling</em> it doesn’t produce an output. Any cells that use the
now-changed functions will also have to be re-run for their output to
change.</p>
<div id="challenge--more-functions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge--more-functions" class="callout-inner">
<h3 class="callout-title">Challenge- More functions<a class="anchor" aria-label="anchor" href="#challenge--more-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Add two arguments to the functions we wrote that take the path of
the directory where the files will be written and the root of the file
name. Create a new set of files with a different name in a different
directory.</li>
<li>How could you use the function <code>yearly_data_csv_writer</code>
to create a csv file for only one year? (Hint: think about the syntax
for <code>range</code>)</li>
<li>Make the functions return a list of the files they have written.
There are many ways you can do this: either of the functions can print
to screen, either can use a return statement to give back numbers or
strings to their function call, or you can use some combination of the
two. You could also try using the <code>os</code> library to list the
contents of directories.</li>
<li>Explore what happens when variables are declared inside each of the
functions versus in the main (non-indented) body of your code. What is
the scope of the variables (where are they visible)? What happens when
they have the same name but are given different values?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save, root_name):</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">    Writes a csv file for data from a given year.</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">    ---------</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">    this_year : int</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">        year for which data is extracted</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">    all_data: pd.DataFrame</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">        DataFrame with multi-year data </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">        folder to save the data files</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">        root of the filenames to save the data</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>    <span class="co"># Select data for the year</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>    texts_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a>    filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a>    texts_year.to_csv(filename)</span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(start_year, end_year, all_data, folder_to_save, root_name):</span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a><span class="co">    Writes separate csv files for each year of data.</span></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb18-29"><a href="#cb18-29" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb18-30"><a href="#cb18-30" tabindex="-1"></a><span class="co">    start_year: int</span></span>
<span id="cb18-31"><a href="#cb18-31" tabindex="-1"></a><span class="co">        the first year of data we want</span></span>
<span id="cb18-32"><a href="#cb18-32" tabindex="-1"></a><span class="co">    end_year: int</span></span>
<span id="cb18-33"><a href="#cb18-33" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb18-34"><a href="#cb18-34" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb18-35"><a href="#cb18-35" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb18-36"><a href="#cb18-36" tabindex="-1"></a><span class="co">    folder_to_save : str</span></span>
<span id="cb18-37"><a href="#cb18-37" tabindex="-1"></a><span class="co">          folder to save the data files</span></span>
<span id="cb18-38"><a href="#cb18-38" tabindex="-1"></a><span class="co">    root_name: str</span></span>
<span id="cb18-39"><a href="#cb18-39" tabindex="-1"></a><span class="co">          root of the filenames to save the data</span></span>
<span id="cb18-40"><a href="#cb18-40" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb18-41"><a href="#cb18-41" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb18-42"><a href="#cb18-42" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb18-43"><a href="#cb18-43" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb18-44"><a href="#cb18-44" tabindex="-1"></a>    years <span class="op">=</span> all_data.publication_date.unique()</span>
<span id="cb18-45"><a href="#cb18-45" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb18-46"><a href="#cb18-46" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb18-47"><a href="#cb18-47" tabindex="-1"></a>      <span class="cf">if</span> year <span class="kw">in</span> years:</span>
<span id="cb18-48"><a href="#cb18-48" tabindex="-1"></a>        one_year_csv_writer(year, all_data, folder_to_save, root_name)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The functions we wrote demand that we give them a value for every
argument. Ideally, we would like these functions to be as flexible and
independent as possible. Let’s modify the function
<code>yearly_data_csv_writer</code> so that the <code>start_year</code>
and <code>end_year</code> default to the full range of the data if they
are not supplied by the user. Arguments can be given default values with
an equal sign in the function declaration. Any arguments in the function
without default values (here, <code>all_data</code>) is a required
argument and MUST come before the argument with default values (which
are optional in the function call).</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="kw">def</span> yearly_data_csv_writer(all_data, start_year<span class="op">=</span><span class="dv">1948</span>, end_year<span class="op">=</span><span class="dv">2024</span>):</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">    Writes separate csv files for each year of data.</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">    start_year: int</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">        the first year of data we want</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">    end_year: int</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">        the last year of data we want</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">    all_data: pandas Dataframe</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">        DataFrame with multi-year data</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">    None</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>    years <span class="op">=</span> all_data.publication_date.unique()</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>    <span class="co"># "end_year" is the last year of data we want to pull, so we loop to end_year+1</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>    <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(start_year, end_year<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>      <span class="cf">if</span> year <span class="kw">in</span> years:</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>        one_year_csv_writer(year, all_data)</span></code></pre>
</div>
<div id="challenge---optional-variables" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---optional-variables" class="callout-inner">
<h3 class="callout-title">Challenge - Optional Variables<a class="anchor" aria-label="anchor" href="#challenge---optional-variables"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens if you only include a value for <code>start_year</code>
in the function call? Can you write the function call with only a value
for <code>end_year</code>? (Hint: think about how the function must be
assigning values to each of the arguments - this is related to the need
to put the arguments without default values before those with default
values in the function definition!)</li>
</ol>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="if-in-loops">If in Loops<a class="anchor" aria-label="anchor" href="#if-in-loops"></a>
<a class="anchor" aria-label="anchor" href="#if-in-loops"></a>
</h2>
<hr class="half-width">
<p>The body of our function used a conditional <em>if</em> loop to check
that values of <code>year</code> are in the dataframe. <em>If</em> loops
execute the body of the loop when some condition is met. They commonly
look something like this:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="cf">if</span> a<span class="op">&lt;</span><span class="dv">0</span>: <span class="co"># meets first condition?</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>    <span class="co"># if a IS less than zero</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a negative number'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="cf">elif</span> a<span class="op">&gt;</span><span class="dv">0</span>: <span class="co"># did not meet first condition. meets second condition?</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and IS more than zero</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a is a positive number'</span>)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="cf">else</span>: <span class="co"># met neither condition</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    <span class="co"># if a ISN'T less than zero and ISN'T more than zero</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'a must be zero!'</span>)</span></code></pre>
</div>
<p>Which would return:</p>
<pre><code>a is a positive number</code></pre>
<p>Change the value of <code>a</code> to see how this function works.
The statement <code>elif</code> means “else if”, and all of the
conditional statements must end in a colon.</p>
<div id="challenge---modifying-functions" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge---modifying-functions" class="callout-inner">
<h3 class="callout-title">Challenge - Modifying functions<a class="anchor" aria-label="anchor" href="#challenge---modifying-functions"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>The code below checks to see whether a directory exists and creates
one if it doesn’t. Add some code to your function that writes out the
CSV files, to check for a directory to write to.</li>
</ol>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>  <span class="cf">if</span> <span class="st">'dir_name_here'</span> <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">'Processed directory exists'</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>      os.mkdir(<span class="st">'dir_name_here'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>      <span class="bu">print</span>(<span class="st">'Processed directory created'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>      <span class="kw">def</span> one_year_csv_writer(this_year, all_data, folder_to_save, root_name):</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>      <span class="co">"""</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">      Writes a csv file for data from a given year.</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">      Parameters</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">      ---------</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">      this_year : int</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">          year for which data is extracted</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">      all_data: pd.DataFrame</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">          DataFrame with multi-year data </span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">      folder_to_save : str</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">          folder to save the data files</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">      root_name: str</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">          root of the filenames to save the data</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">      """</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>      <span class="cf">if</span> folder_to_save <span class="kw">in</span> os.listdir(<span class="st">'.'</span>):</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'Output directory exists'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>        os.mkdir(folder_to_save)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">'folder_to_save, directory created'</span>)</span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>      <span class="co"># Select data for the year</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>      texts_year <span class="op">=</span> all_data[all_data.year <span class="op">==</span> this_year]</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>      <span class="co"># Write the new DataFrame to a csv file</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a>      filename <span class="op">=</span> os.path.join(folder_to_save, <span class="st">''</span>.join([root_name, <span class="bu">str</span>(this_year), <span class="st">'.csv'</span>]))</span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>      texts_year.to_csv(filename)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="aio-visualization-ggplot-python"><p>Content from <a href="visualization-ggplot-python.html">Plotting</a></p>
<hr>
<p>Last updated on 2024-06-20 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/visualization-ggplot-python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Can I use Python to create plots?</li>
<li>How can I customize plots generated in Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create plot objects</li>
<li>Change the aesthetics of a plot such as colour</li>
<li>Edit the axis labels</li>
<li>Create customized plot styles to meet their needs</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level5">
<h5 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h5>
</div>
<section><h2 class="section-heading" id="plotting-with-matplotlib">Plotting with Matplotlib<a class="anchor" aria-label="anchor" href="#plotting-with-matplotlib"></a>
<a class="anchor" aria-label="anchor" href="#plotting-with-matplotlib"></a>
</h2>
<hr class="half-width">
<p>Matplotlib is a Python library that can be used to visualize data.
Pandas has powerful built-in plotting capabilities based off of
<code>matplotlib</code>, but more flexibility is available to us if
access <code>matplotlib</code> directly. The toolbox
<code>matplotlib.pyplot</code> is a collection of functions that make
matplotlib work like MATLAB. In most cases, this is all that you will
need to use, but there are many other useful tools in matplotlib that
you should explore.</p>
<p>We will cover a few basic commands for formatting plots in this
lesson. A great resource for help styling your figures is the matplotlib
gallery (<a href="https://matplotlib.org/gallery.html" class="external-link">http://matplotlib.org/gallery.html</a>),
which includes plots in many different styles and the source code that
creates them.</p>
<p>The simplest of plots is the 2 dimensional line plot. These next few
examples walk through the basic commands for making line plots using
pyplots.</p>
<div class="section level3">
<h3 id="using-pyplot">Using pyplot:<a class="anchor" aria-label="anchor" href="#using-pyplot"></a>
</h3>
<p>First, import the pyplot toolbox:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>    <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre>
</div>
<p>We can start by plotting the values of a list of numbers (matplotlib
can handle many types of numeric data, including numpy arrays and pandas
DataFrames - we are just using a list as an example!):</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>    list_numbers <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>]</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>    plt.plot(list_numbers)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>The command <code>plt.show()</code> prompts Python to display the
figure. Without it, it creates an object in memory but doesn’t produce a
visible plot.</p>
<p>If you provide the <code>plot()</code> function with only one list of
numbers, it assumes that it is a sequence of y-values and plots them
against their index (the first value in the list is plotted at
<code>x=0</code>, the second at <code>x=1</code>, etc). If the function
<code>plot()</code> receives two lists, it assumes the first one is the
x-values and the second the y-values. The line connecting the points
will follow the list in order:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>    plt.plot(list_numbers,[<span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">800</span>, <span class="dv">1600</span>])</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>A third, optional argument in <code>plot()</code> is a string of
characters that indicates the line type and color for the plot. The
default value is a continuous blue line. For example, we can make the
line red (<code>'r'</code>), with circles at every data point
(<code>'o'</code>), and a dot-dash pattern (<code>'-.'</code>). Look
through the matplotlib gallery for more examples.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>    plt.plot(list_numbers,[<span class="dv">200</span>, <span class="dv">400</span>, <span class="dv">800</span>, <span class="dv">1600</span>], <span class="st">'ro-.'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    plt.axis([<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">2000</span>])</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>The command <code>plt.axis()</code> sets the limits of the axes from
a list of <code>[xmin, xmax, ymin, ymax]</code> values (the square
brackets are needed because the argument for the function
<code>axis()</code> is one list of values, not four separate
numbers!).</p>
<p>A single figure can include multiple lines. We can include a legend
by adding the optional keyword argument <code>label=''</code> in
<code>plot()</code> and then call <code>plt.legend()</code>. The
functions <code>xlabel()</code> and <code>ylabel()</code> will label the
axes, and <code>title()</code> will write a title above the figure:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># convert acquistion to datetime data type</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>works_df.acquisition_date <span class="op">=</span> pd.to_datetime(works_df[<span class="st">'acquisition_date'</span>])</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># subset on flag</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>dei <span class="op">=</span> works_df[works_df[<span class="st">'is_dei'</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>non_dei <span class="op">=</span> works_df[works_df[<span class="st">'is_dei'</span>] <span class="op">==</span> <span class="va">False</span>]</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co"># Group by acquisition year (or another suitable period)</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>acquisition_dei <span class="op">=</span> dei.resample(<span class="st">'Y'</span>, on<span class="op">=</span><span class="st">'acquisition_date'</span>).size()</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>acquisition_non_dei <span class="op">=</span> non_dei.resample(<span class="st">'Y'</span>, on<span class="op">=</span><span class="st">'acquisition_date'</span>).size()</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>works <span class="op">=</span> works_df.resample(<span class="st">'Y'</span>, on<span class="op">=</span><span class="st">'acquisition_date'</span>).size()</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>plt.plot(acquisition_dei.index, acquisition_dei.values,<span class="st">"r--"</span>,label<span class="op">=</span><span class="st">"DEI"</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>plt.plot(acquisition_non_dei.index, acquisition_non_dei.values,<span class="st">"g^"</span>,label<span class="op">=</span><span class="st">"non-DEI"</span>)</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>plt.plot(works.index, works.values,<span class="st">"bo-"</span>,label<span class="op">=</span><span class="st">"Combined"</span>,alpha<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>plt.title(<span class="st">'Number of Acquisitions Over Time'</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Acquisitions'</span>)</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>plt.legend()</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<p>Like MATLAB, pyplot is stateful; it keeps track of the current figure
and plotting area, and any plotting functions are directed to those
axes. To make more than one figure, we use the command
<code>plt.figure()</code> with an increasing figure number inside the
parentheses:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>    <span class="co"># this is the first figure</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    plt.plot(acquisition_dei.index, acquisition_dei.values,<span class="st">"r--"</span>,label<span class="op">=</span><span class="st">"DEI"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">'upper left'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    plt.title(<span class="st">'This is figure 1'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="co"># this is a second figure</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    plt.figure(<span class="dv">2</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    plt.plot(acquisition_non_dei.index, acquisition_non_dei.values,<span class="st">"g^"</span>,label<span class="op">=</span><span class="st">"non-DEI"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    plt.legend(loc<span class="op">=</span><span class="st">'lower right'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span>)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    plt.title(<span class="st">'This is figure 2'</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<p>A single figure can also include multiple plots in a grid pattern.
The <code>subplot()</code> command specifies the number of rows, the
number of columns, and the number of the space in the grid that
particular plot is occupying:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>    plt.figure(<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>) <span class="co"># two row, two columns, position 1</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    plt.plot(works.index, works.values,<span class="st">"bo-"</span>,label<span class="op">=</span><span class="st">"Combined"</span>,alpha<span class="op">=</span><span class="fl">.25</span>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>) <span class="co"># two row, two columns, position 2</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    plt.plot(acquisition_dei.index, acquisition_dei.values,<span class="st">"r--"</span>,label<span class="op">=</span><span class="st">"DEI"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) <span class="co"># two row, two columns, position 3</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    plt.plot(acquisition_non_dei.index, acquisition_non_dei.values,<span class="st">"g^"</span>,label<span class="op">=</span><span class="st">"non-DEI"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>    plt.show()</span></code></pre>
</div>
<div id="what-can-we-and-cant-we-ask" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="what-can-we-and-cant-we-ask" class="callout-inner">
<h3 class="callout-title">What can we and can’t we ask?<a class="anchor" aria-label="anchor" href="#what-can-we-and-cant-we-ask"></a>
</h3>
<div class="callout-content">
<ul>
<li>What other DEI related questions could you ask of the data as
is?<br>
</li>
<li>What questions could you answer by reformulating the data currently
in the dataset.<br>
</li>
<li>What is a question you have that cannot be answered with the current
data?
<ul>
<li>How would you go about getting the data needed.</li>
<li>How much would that data cost in time, effort, dollars?</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div id="make-other-types-of-plots" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="make-other-types-of-plots" class="callout-inner">
<h3 class="callout-title">Make other types of plots:<a class="anchor" aria-label="anchor" href="#make-other-types-of-plots"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a histogram of checkouts.</p></li>
<li><p>Run the following code:</p></li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>ethnicity_df <span class="op">=</span> pd.read_csv(<span class="st">'ethnicity.csv'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>ethnicity_df.loc[ethnicity_df.intl.isnull(),[<span class="st">'intl'</span>]]<span class="op">=</span> ethnicity_df.intl.<span class="bu">min</span>()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>ethnicity_df.intl <span class="op">=</span> ethnicity_df.intl.astype(<span class="st">'int'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>plot_df <span class="op">=</span> ethnicity_df[ethnicity_df.term <span class="op">==</span> <span class="st">'Fall'</span>]</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>plot_df.set_index(<span class="st">'year'</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>plot_df <span class="op">=</span> plot_df.sort_index()</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>plot_df</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>plot_df[[<span class="st">'amind'</span>, <span class="st">'black'</span>, <span class="st">'hispanic'</span>, <span class="st">'asian'</span>,<span class="st">'pacific_islander'</span>, <span class="st">'multi'</span>, <span class="st">'white'</span>, <span class="st">'unknown'</span>, <span class="st">'intl'</span>]].plot()</span></code></pre>
</div>
<p>Use a <em>for</em> loop to recreate that plot using matplotlib. Make
sure you have a title, legend, and label your axis.
<strong>Hint:</strong> You can reuse plot_df.</p>
<ol start="3" style="list-style-type: decimal">
<li>Matplotlib can make many other types of plots in much the same way
that it makes 2 dimensional line plots. Look through the examples in <a href="https://matplotlib.org/users/screenshots.html" class="external-link">http://matplotlib.org/users/screenshots.html</a>
and try a few of them (click on the “Source code” link and copy and
paste into a new cell in ipython notebook or save as a text file with a
<code>.py</code> extension and run in the command line).</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>plt.hist(works_df[<span class="st">'checkouts'</span>], bins<span class="op">=</span><span class="bu">len</span>(works_df[<span class="st">'checkouts'</span>].unique()), log<span class="op">=</span><span class="va">True</span>, edgecolor<span class="op">=</span><span class="st">'black'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>plt.title(<span class="st">'Histogram of Checkouts (Logarithmic Y-axis)'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>plt.xlabel(<span class="st">'Checkouts'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>plt.ylabel(<span class="st">'Frequency (log scale)'</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>
</li></ol>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">'amind'</span>, <span class="st">'black'</span>, <span class="st">'hispanic'</span>, <span class="st">'asian'</span>,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>       <span class="st">'pacific_islander'</span>, <span class="st">'multi'</span>, <span class="st">'white'</span>, <span class="st">'unknown'</span>, <span class="st">'intl'</span>]</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>styles <span class="op">=</span> [<span class="st">'r-'</span>, <span class="st">'b--'</span>, <span class="st">'-.'</span>, <span class="st">':'</span>, <span class="st">'r--'</span>, <span class="st">'b-'</span>, <span class="st">'g-'</span>, <span class="st">'g--'</span>, <span class="st">'r-.'</span>]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="cf">for</span> ethnicity <span class="kw">in</span> <span class="bu">enumerate</span>(cols):</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    plt.plot(plot_df.index,plot_df[ethnicity[<span class="dv">1</span>]],styles[ethnicity[<span class="dv">0</span>]],label <span class="op">=</span> ethnicity[<span class="dv">1</span>],alpha<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>plt.legend()</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of Students'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>plt.xlabel(<span class="st">'Year'</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>plt.title(<span class="st">'Students by Ethnicity'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="plotting-with-other-libraries-">Plotting with other libraries.<a class="anchor" aria-label="anchor" href="#plotting-with-other-libraries."></a>
<a class="anchor" aria-label="anchor" href="#plotting-with-other-libraries-"></a>
</h2>
<hr class="half-width">
<p><code>matplotlib</code> is not your only option. There are many other
libraries that can simplify the steps required or add additional
functionality with <code>seaborn</code> and <code>bokeh</code> being
just two examples. There is no way to cover them all here, but be aware
that you have options and that you should not let differences in syntax
dissuade you from exploring to finding the right fit for your needs.</p>
</section></section><section id="aio-working-with-sql"><p>Content from <a href="working-with-sql.html">Accessing SQLite Databases Using Python &amp; Pandas</a></p>
<hr>
<p>Last updated on 2024-05-16 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/working-with-sql.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section><h2 class="section-heading" id="python-and-sql">Python and SQL<a class="anchor" aria-label="anchor" href="#python-and-sql"></a>
<a class="anchor" aria-label="anchor" href="#python-and-sql"></a>
</h2>
<hr class="half-width">
<p>When you open a CSV in python, and assign it to a variable name, you
are using your computers memory to save that variable. Accessing data
from a database like SQL is not only more efficient, but also it allows
you to subset and import only the parts of the data that you need.</p>
<p>In the following lesson, we’ll see some approaches that can be taken
to do so.</p>
<div class="section level3">
<h3 id="the-sqlite3-module">The <code>sqlite3</code> module<a class="anchor" aria-label="anchor" href="#the-sqlite3-module"></a>
</h3>
<p>The <a href="https://docs.python.org/3/library/sqlite3.html" class="external-link">sqlite3</a> module
provides a straightforward interface for interacting with SQLite
databases. A connection object is created using
<code>sqlite3.connect()</code>; the connection must be closed at the end
of the session with the <code>.close()</code> command. While the
connection is open, any interactions with the database require you to
make a cursor object with the <code>.cursor()</code> command. The cursor
is then ready to perform all kinds of operations with
<code>.execute()</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"all_works.db"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># the result of a "cursor.execute" can be iterated over by row</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> cur.execute(<span class="st">'SELECT * FROM all_works LIMIT 100;'</span>):</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="co">#Be sure to close the connection.</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>One of the most common ways to interact with a database is by
querying: retrieving data based on some search parameters. Use a SELECT
statement string. The query is returned as a single tuple or a tuple of
tuples. Add a WHERE statement to filter your results based on some
parameter.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Create a SQL connection to our SQLite database</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"all_works.db"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># Return all results of query</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>cur.execute(<span class="st">'SELECT mms_id FROM checkouts WHERE checkouts&gt;0'</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>checked_out <span class="op">=</span> cur.fetchall()</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co"># Return first result of query</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>cur.execute(<span class="st">'SELECT checkouts FROM checkouts WHERE mms_id="991000199359702908"'</span>)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>checkout_for_id <span class="op">=</span> cur.fetchone()</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#Be sure to close the connection.</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="accessing-data-stored-in-sqlite-using-python-and-pandas">Accessing data stored in SQLite using Python and Pandas<a class="anchor" aria-label="anchor" href="#accessing-data-stored-in-sqlite-using-python-and-pandas"></a>
<a class="anchor" aria-label="anchor" href="#accessing-data-stored-in-sqlite-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>Using pandas, we can import results of a SQLite query into a
dataframe.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Read sqlite query results into a pandas DataFrame</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">"all_works.db"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from all_works"</span>, con)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># verify that result of SQL query is stored in the dataframe</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div id="challenge---sql" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---sql" class="callout-inner">
<h3 class="callout-title">Challenge - SQL<a class="anchor" aria-label="anchor" href="#challenge---sql"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a query that contains title data published between 2008 and
2015 that includes book’s Title, Author, and mms_id. How many records
are returned?</li>
</ol>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="storing-data-csv-vs-sqlite">Storing data: CSV vs SQLite<a class="anchor" aria-label="anchor" href="#storing-data-csv-vs-sqlite"></a>
<a class="anchor" aria-label="anchor" href="#storing-data-csv-vs-sqlite"></a>
</h2>
<hr class="half-width">
<p>Storing your data in an SQLite database can provide substantial
performance improvements when reading/writing compared to CSV. The
difference in performance becomes more noticable as the size of the
dataset grows (see for example <a href="https://sebastianraschka.com/Articles/2013_sqlite_database.html#results-and-conclusions" class="external-link">these
benchmarks</a>).</p>
</section><section><h2 class="section-heading" id="storing-data-create-new-tables-using-pandas">Storing data: Create new tables using Pandas<a class="anchor" aria-label="anchor" href="#storing-data-create-new-tables-using-pandas"></a>
<a class="anchor" aria-label="anchor" href="#storing-data-create-new-tables-using-pandas"></a>
</h2>
<hr class="half-width">
<p>We can also us pandas to create new tables within an SQLite database.
Here, we will filter the dataframe to only works published in 2010, and
then save it out to its own table so we can work with it on its own
later.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># Establish connection to the SQLite database</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="cf">with</span> sqlite3.<span class="ex">connect</span>(<span class="st">"all_works.db"</span>) <span class="im">as</span> con:</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="co"># Load the data into a DataFrame</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    books_df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from all_works"</span>, con)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="co"># Select only data for 2010</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    titles_2010 <span class="op">=</span> books_df[books_df.publication_date <span class="op">==</span> <span class="st">'2010'</span>]</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="cf">with</span> sqlite3.<span class="ex">connect</span>(<span class="st">"all_works.db"</span>) <span class="im">as</span> con:</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="co"># Write the new DataFrame to a new SQLite table</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    titles_2010.to_sql(<span class="st">"titles_2010"</span>, con, if_exists<span class="op">=</span><span class="st">"replace"</span>)</span></code></pre>
</div>
<div id="challenge---saving-your-work" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---saving-your-work" class="callout-inner">
<h3 class="callout-title">Challenge - Saving your work<a class="anchor" aria-label="anchor" href="#challenge---saving-your-work"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create your own filter; modify the code to save results to its
own tables in the all_works database.</p></li>
<li><p>What are some of the reasons you might want to save the results
of your queries back into the database? What are some of the reasons you
might avoid doing this.</p></li>
</ol>
</div>
</div>
</div>
</section></section><section id="aio-putting-it-all-together"><p>Content from <a href="putting-it-all-together.html">Putting It All Together</a></p>
<hr>
<p>Last updated on 2024-05-21 |

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/episodes/putting-it-all-together.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What common issues might be encountered with real world data.</li>
<li>How can plotting and other techniques help with exploratory analysis
and getting to know my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learners import, clean, and plot their own data.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="putting-it-all-together">Putting it all together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a>
</h2>
<hr class="half-width">
<p>Up to this point, we have walked through tasks that are often
involved in handling and processing data using the workshop ready
cleaned<br>
files that we have provided. In this wrap-up exercise, we will perform
many of the same tasks with real data sets.</p>
<p>As opposed to the previous ones, this lesson does not give
step-by-step directions to each of the tasks. Use the lesson materials
you’ve already gone through as well as the Python documentation to help
you along.</p>
</section><section><h2 class="section-heading" id="obtain-data">1. Obtain data<a class="anchor" aria-label="anchor" href="#obtain-data"></a>
<a class="anchor" aria-label="anchor" href="#obtain-data"></a>
</h2>
<hr class="half-width">
<p>There are many repositories online from which you can obtain data. We
are providing you with one data file to use with these exercises
(<code>works-original.csv</code>), but feel free to use any data that is
relevant to your research. You can also explore the <a href="https://glam-workbench.net/" class="external-link">GLAM Workbench</a> for data set ideas
as well as examples of the full potential of <strong>Humanities
Computing</strong>.</p>
</section><section><h2 class="section-heading" id="clean-up-your-data-and-open-it-using-python-and-pandas">2. Clean up your data and open it using Python and Pandas<a class="anchor" aria-label="anchor" href="#clean-up-your-data-and-open-it-using-python-and-pandas"></a>
<a class="anchor" aria-label="anchor" href="#clean-up-your-data-and-open-it-using-python-and-pandas"></a>
</h2>
<hr class="half-width">
<p>To begin, import your data file into Python using Pandas. Did it
fail? Your data file may have metadata that Pandas does not recognize as
part of the data table. Remove this metadata, but do not simply delete
it in a text editor! Use either a shell script or Python to do this -
you wouldn’t want to do it by hand if you had many files to process.</p>
<p>If you are still having trouble importing the data as a table using
Pandas, check the documentation. You can open the docstring in an
ipython notebook using a question mark. For example:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    pd.read_csv?</span></code></pre>
</div>
<p>Look through the function arguments to see if there is a default
value that is different from what your file requires (Hint: the problem
is most likely the delimiter or separator. Common delimiters are
<code>','</code> for comma, <code>' '</code> for space, and
<code>'\t'</code> for tab).</p>
<p>Create a DataFrame that includes only the values of the data that are
useful to you. You can also change the name of the columns in the
DataFrame like this:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">"A"</span>: <span class="st">"Column1"</span>, <span class="st">"B"</span>: <span class="st">"Column2"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<div id="challenge---lots-of-plots" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---lots-of-plots" class="callout-inner">
<h3 class="callout-title">Challenge - Lots of plots<a class="anchor" aria-label="anchor" href="#challenge---lots-of-plots"></a>
</h3>
<div class="callout-content">
<p>Make a variety of plots from your data. Add axis labels, titles, and
legends to your figures. Make at least one figure with multiple plots
using the function <code>subplot()</code>.</p>
</div>
</div>
</div>
<div id="challenge---final-plot" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge---final-plot" class="callout-inner">
<h3 class="callout-title">Challenge - Final Plot<a class="anchor" aria-label="anchor" href="#challenge---final-plot"></a>
</h3>
<div class="callout-content">
<p>Display your data using one or more plot types from the example
gallery (<a href="https://matplotlib.org/gallery.html" class="external-link">http://matplotlib.org/gallery.html</a>).
Which ones to choose will depend on the content of your own data file.
For example, consider if any of your data would benefit from being
presented as a histogram, a bar plot, or explore the different ways
matplotlib can handle dates and times for figures.</p>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/carpentries-incubator/python-humanities-lesson/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/carpentries-incubator/python-humanities-lesson/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/carpentries-incubator/python-humanities-lesson/" class="external-link">Source</a></p>
				<p><a href="https://github.com/carpentries-incubator/python-humanities-lesson/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "identifier": "https://carpentries-incubator.github.io/python-humanities-lesson/instructor/aio.html",
  "dateCreated": "2024-08-05",
  "dateModified": "2024-08-05",
  "datePublished": "2024-08-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

